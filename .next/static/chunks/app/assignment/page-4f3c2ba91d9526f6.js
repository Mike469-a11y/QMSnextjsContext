(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[350],{1484:()=>{},4018:(e,s,t)=>{"use strict";t.d(s,{default:()=>i});var n=t(5155),r=t(5695),a=t(2115);t(1484);let i=()=>{let[e,s]=(0,a.useState)([]),[t,i]=(0,a.useState)(""),[l,o]=(0,a.useState)("all"),[d,c]=(0,a.useState)([]),[u,h]=(0,a.useState)([]),g="2025-07-28 21:04:14",m="MFakheem",x=(0,r.useRouter)();(0,a.useEffect)(()=>{let e=localStorage.getItem("assignmentEntries");if(e){let t=JSON.parse(e);s(t),c(t),console.log("Loaded Assignment entries:",t)}j();let t=e=>{"users"===e.key&&j()};window.addEventListener("storage",t);let n=setInterval(j,1e3);return()=>{window.removeEventListener("storage",t),clearInterval(n)}},[]);let j=()=>{let e=localStorage.getItem("users");if(e){let s=JSON.parse(e);h(s),console.log("Loaded users:",s)}else console.log("No users found in localStorage")};(0,a.useEffect)(()=>{let s=e;if(t&&(s=s.filter(e=>e.portalName.toLowerCase().includes(t.toLowerCase())||e.bidNumber.toLowerCase().includes(t.toLowerCase())||e.id.toLowerCase().includes(t.toLowerCase())||e.hunterName&&e.hunterName.toLowerCase().includes(t.toLowerCase()))),"all"!==l){let e=new Date;s=s.filter(s=>{let t=Math.ceil((new Date(s.dueDate)-e)/864e5);switch(l){case"overdue":return t<0;case"due-soon":return t>=0&&t<=7;case"active":return t>7;default:return!0}})}c(s)},[e,t,l]);let p=e=>{console.log("Transferring entry to sourcing:",e);let s=localStorage.getItem("sourcingEntries"),t=s?JSON.parse(s):[];console.log("Existing sourcing entries:",t);let n=t.findIndex(s=>s.id===e.id);n>=0?(t[n]={...e,transferredAt:g,transferredBy:m},console.log("Updated existing entry in sourcing")):(t.push({...e,transferredAt:g,transferredBy:m}),console.log("Added new entry to sourcing")),localStorage.setItem("sourcingEntries",JSON.stringify(t)),console.log("Saved to localStorage:",t);let r=document.createElement("div");r.style.cssText="\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            background: linear-gradient(135deg, #28a745, #20c997);\n            color: white;\n            padding: 12px 20px;\n            border-radius: 8px;\n            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);\n            z-index: 10000;\n            font-weight: 600;\n            animation: slideIn 0.3s ease-out;\n        ",r.innerHTML="✅ Entry ".concat(e.id," transferred to Sourcing!"),document.body.appendChild(r);let a=document.createElement("style");a.textContent="\n            @keyframes slideIn {\n                from { transform: translateX(100%); opacity: 0; }\n                to { transform: translateX(0); opacity: 1; }\n            }\n        ",document.head.appendChild(a),setTimeout(()=>{r.remove(),a.remove()},3e3)},N=e=>{if(!e)return"";let s=new Date,t=Math.ceil((new Date(e)-s)/864e5);return t<0?"overdue":t<=3?"due-soon":""};return(0,n.jsxs)("div",{className:"assignment-container",children:[(0,n.jsxs)("div",{className:"assignment-header",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:"Assignment Dashboard"}),(0,n.jsx)("p",{children:"Track and manage your QMS entries with deadlines and priorities"})]}),(0,n.jsxs)("div",{className:"user-info",children:[(0,n.jsxs)("span",{children:["Current User: ",(0,n.jsx)("strong",{children:m})]}),(0,n.jsxs)("span",{children:["Date: ",(0,n.jsxs)("strong",{children:[g," UTC"]})]})]})]}),(0,n.jsxs)("div",{style:{background:"#f8f9fa",border:"1px solid #dee2e6",borderRadius:"8px",padding:"10px",margin:"10px 0",fontSize:"12px",fontFamily:"monospace"},children:[(0,n.jsx)("strong",{children:"\uD83D\uDC1B Debug Info:"}),(0,n.jsx)("br",{}),"Assignment Entries: ",e.length," | Users Loaded: ",u.length," | Filtered Results: ",d.length,(0,n.jsx)("br",{}),(0,n.jsx)("small",{children:"Check browser console for detailed logs"})]}),(0,n.jsxs)("div",{className:"assignment-controls",children:[(0,n.jsxs)("div",{className:"search-filter-section",children:[(0,n.jsxs)("div",{className:"search-container",children:[(0,n.jsx)("input",{type:"text",placeholder:"Search by Portal, Bid Number, QMS ID, or Hunter Name...",value:t,onChange:e=>i(e.target.value),className:"search-input"}),(0,n.jsx)("span",{className:"search-icon",children:"\uD83D\uDD0D"})]}),(0,n.jsx)("div",{className:"filter-container",children:(0,n.jsxs)("select",{value:l,onChange:e=>o(e.target.value),className:"filter-select",children:[(0,n.jsx)("option",{value:"all",children:"All Entries"}),(0,n.jsx)("option",{value:"overdue",children:"Overdue"}),(0,n.jsx)("option",{value:"due-soon",children:"Due Soon (≤7 days)"}),(0,n.jsx)("option",{value:"active",children:"Active (7 days)"})]})})]}),(0,n.jsxs)("div",{className:"assignment-actions",children:[(0,n.jsx)("button",{className:"btn-primary",onClick:()=>x.push("/"),children:"➕ Add New Entry"}),(0,n.jsx)("button",{className:"btn-secondary",onClick:()=>window.print(),children:"\uD83D\uDDA8️ Print Report"}),(0,n.jsx)("button",{className:"btn-sourcing",onClick:()=>x.push("/sourcing"),children:"\uD83C\uDFAF Go to Sourcing"})]})]}),(0,n.jsxs)("div",{className:"assignment-list-container",children:[(0,n.jsxs)("table",{className:"assignment-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"QMS ID"}),(0,n.jsx)("th",{children:"Date"}),(0,n.jsx)("th",{children:"Portal Name"}),(0,n.jsx)("th",{children:"Bid Number"}),(0,n.jsx)("th",{children:"Hunter"}),(0,n.jsx)("th",{children:"Due Date"}),(0,n.jsx)("th",{children:"Status"}),(0,n.jsx)("th",{children:"Priority"}),(0,n.jsx)("th",{children:"Days Left"}),(0,n.jsx)("th",{children:"Actions"}),(0,n.jsx)("th",{children:"Assign To"}),(0,n.jsx)("th",{children:"Assigned By"})]})}),(0,n.jsx)("tbody",{children:0===d.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:12,children:(0,n.jsxs)("div",{className:"no-assignments-message",children:[(0,n.jsx)("div",{className:"no-assignments-icon",children:"\uD83D\uDCCB"}),(0,n.jsx)("h3",{children:"No Entries Found"}),(0,n.jsx)("p",{children:0===e.length?"No QMS entries have been created yet.":"No entries match your current search criteria."}),0===e.length&&(0,n.jsx)("button",{className:"btn-create-first",onClick:()=>x.push("/"),children:"Create Your First Entry"})]})})}):d.map(t=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)("div",{className:"assignment-id-cell",children:t.id})}),(0,n.jsx)("td",{children:t.date||"N/A"}),(0,n.jsx)("td",{children:(0,n.jsx)("div",{className:"assignment-title",children:t.portalName||"N/A"})}),(0,n.jsx)("td",{children:(0,n.jsx)("strong",{children:t.bidNumber||"N/A"})}),(0,n.jsx)("td",{children:(0,n.jsx)("div",{className:"hunter-name",children:t.hunterName||"Not Assigned"})}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:"due-date ".concat(N(t.dueDate)),children:t.dueDate||"No due date"})}),(0,n.jsx)("td",{children:(e=>{let s=new Date,t=Math.ceil((new Date(e.dueDate)-s)/864e5);return t<0?(0,n.jsx)("span",{className:"status-badge status-overdue",children:"Overdue"}):t<=3?(0,n.jsx)("span",{className:"status-badge status-review",children:"Critical"}):t<=7?(0,n.jsx)("span",{className:"status-badge status-in-progress",children:"In Progress"}):(0,n.jsx)("span",{className:"status-badge status-not-started",children:"Active"})})(t)}),(0,n.jsx)("td",{children:(e=>{if(!e)return null;let s=new Date,t=Math.ceil((new Date(e)-s)/864e5);return t<0?(0,n.jsx)("span",{className:"priority-badge priority-critical",children:"Overdue"}):t<=3?(0,n.jsx)("span",{className:"priority-badge priority-high",children:"Urgent"}):t<=7?(0,n.jsx)("span",{className:"priority-badge priority-medium",children:"Soon"}):(0,n.jsx)("span",{className:"priority-badge priority-low",children:"Normal"})})(t.dueDate)}),(0,n.jsx)("td",{children:(0,n.jsx)("strong",{className:N(t.dueDate),children:(e=>{if(!e)return"No due date";let s=new Date,t=Math.ceil((new Date(e)-s)/864e5);return t>=0?"".concat(t," days"):"Overdue by ".concat(Math.abs(t)," days")})(t.dueDate)})}),(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:"action-buttons",children:[(0,n.jsx)("button",{className:"btn-view",onClick:()=>{let e;return e=t.id,x.push("/qms/".concat(e))},title:"View Details",children:"View"}),(0,n.jsx)("button",{className:"btn-delete",onClick:()=>(t=>{if(!window.confirm("Are you sure you want to delete this entry from Assignment? Note: This will NOT delete it from other sections."))return;console.log("Attempting to delete entry ".concat(t," from Assignment"));let n=e.filter(e=>e.id!==t);s(n),localStorage.setItem("assignmentEntries",JSON.stringify(n)),console.log("Entry ".concat(t," deleted from Assignment. Remaining entries:"),n),alert("Entry ".concat(t," has been deleted from Assignment section only."))})(t.id),title:"Delete Entry from Assignment only",children:"\uD83D\uDDD1️"})]})}),(0,n.jsx)("td",{children:(0,n.jsx)("div",{className:"assign-to-container",children:(0,n.jsxs)("select",{className:"assign-to-select",value:t.assignedUserId||"",onChange:n=>((t,n)=>{if(!n)return;console.log("Assigning user ".concat(n," to entry ").concat(t));let r=u.find(e=>e.id.toString()===n);if(!r)return void console.log("User not found:",n);console.log("Selected user:",r);let a=e.map(e=>{if(e.id===t){let s={...e,hunterName:r.name,assignedUserId:r.id,assignedAt:g,assignedBy:e.assignedBy||""};return console.log("Updated entry:",s),s.hunterName&&s.assignedBy?(console.log("Both Assign To and Assigned By are set, transferring to sourcing"),p(s)):console.log("Not transferring to sourcing. hunterName:",s.hunterName,"assignedBy:",s.assignedBy),s}return e});s(a),localStorage.setItem("assignmentEntries",JSON.stringify(a)),alert('Successfully assigned "'.concat(r.name,'" to entry ').concat(t))})(t.id,n.target.value),title:"Assign this entry to a user",children:[(0,n.jsx)("option",{value:"",children:"Select User..."}),u.map(e=>(0,n.jsxs)("option",{value:e.id,children:[e.name," (",e.role,")"]},e.id))]})})}),(0,n.jsx)("td",{children:(0,n.jsx)("div",{className:"assigned-by-container",children:(0,n.jsxs)("select",{className:"assigned-by-select",value:t.assignedBy||"",onChange:n=>((t,n)=>{console.log("Setting assignedBy for entry ".concat(t," to:"),n);let r=e.map(e=>{if(e.id===t){let s={...e,assignedBy:n,assignedByAt:g,assignedByUser:m};return console.log("Updated entry:",s),s.hunterName&&s.assignedBy?(console.log("Both Assign To and Assigned By are set, transferring to sourcing"),p(s)):console.log("Not transferring to sourcing. hunterName:",s.hunterName,"assignedBy:",s.assignedBy),s}return e});s(r),localStorage.setItem("assignmentEntries",JSON.stringify(r))})(t.id,n.target.value),title:"Select who assigned this entry",children:[(0,n.jsx)("option",{value:"",children:"Select..."}),(0,n.jsx)("option",{value:"Joe",children:"Joe"}),(0,n.jsx)("option",{value:"Jack",children:"Jack"})]})})})]},t.id))})]}),d.length>0&&(0,n.jsx)("div",{className:"table-footer",children:(0,n.jsxs)("div",{className:"results-info",children:["Showing ",d.length," of ",e.length," entries"]})})]})]})}},5695:(e,s,t)=>{"use strict";var n=t(8999);t.o(n,"usePathname")&&t.d(s,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(s,{useRouter:function(){return n.useRouter}})},7586:(e,s,t)=>{Promise.resolve().then(t.bind(t,4018))}},e=>{e.O(0,[989,441,964,358],()=>e(e.s=7586)),_N_E=e.O()}]);