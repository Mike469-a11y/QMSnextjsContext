(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[563],{2501:(e,a,t)=>{"use strict";t.d(a,{A:()=>i});class s{async initDB(){return new Promise((e,a)=>{let t=indexedDB.open(this.dbName,this.version);t.onerror=()=>a(t.error),t.onsuccess=()=>{this.db=t.result,e(this.db)},t.onupgradeneeded=e=>{let a=e.target.result;if(!a.objectStoreNames.contains("attachments")){let e=a.createObjectStore("attachments",{keyPath:"id"});e.createIndex("vendorId","vendorId",{unique:!1}),e.createIndex("qmsId","qmsId",{unique:!1})}a.objectStoreNames.contains("sourcingData")||a.createObjectStore("sourcingData",{keyPath:"qmsId"})}})}async saveAttachment(e){return this.db||await this.initDB(),new Promise((a,t)=>{let s=this.db.transaction(["attachments"],"readwrite").objectStore("attachments").put(e);s.onsuccess=()=>a(s.result),s.onerror=()=>t(s.error)})}async getAttachment(e){return this.db||await this.initDB(),new Promise((a,t)=>{let s=this.db.transaction(["attachments"],"readonly").objectStore("attachments").get(e);s.onsuccess=()=>a(s.result),s.onerror=()=>t(s.error)})}async getAttachmentsByVendor(e,a){return this.db||await this.initDB(),new Promise((t,s)=>{let i=this.db.transaction(["attachments"],"readonly").objectStore("attachments").index("vendorId").getAll(e);i.onsuccess=()=>{t(i.result.filter(e=>e.qmsId===a))},i.onerror=()=>s(i.error)})}async deleteAttachment(e){return this.db||await this.initDB(),new Promise((a,t)=>{let s=this.db.transaction(["attachments"],"readwrite").objectStore("attachments").delete(e);s.onsuccess=()=>a(!0),s.onerror=()=>t(s.error)})}async saveSourcingData(e,a){return this.db||await this.initDB(),new Promise((t,s)=>{let i=this.db.transaction(["sourcingData"],"readwrite").objectStore("sourcingData").put({qmsId:e,data:a,lastUpdated:new Date});i.onsuccess=()=>t(i.result),i.onerror=()=>s(i.error)})}async getSourcingData(e){return this.db||await this.initDB(),new Promise((a,t)=>{let s=this.db.transaction(["sourcingData"],"readonly").objectStore("sourcingData").get(e);s.onsuccess=()=>{var e;return a((null==(e=s.result)?void 0:e.data)||null)},s.onerror=()=>t(s.error)})}async compressImage(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1920,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8;return new Promise(s=>{let i=document.createElement("canvas"),d=i.getContext("2d"),n=new Image;n.onload=()=>{let e=Math.min(a/n.width,a/n.height);i.width=n.width*e,i.height=n.height*e,d.drawImage(n,0,0,i.width,i.height),i.toBlob(s,"image/jpeg",t)},n.src=URL.createObjectURL(e)})}generateAttachmentId(){return"att_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}constructor(){this.dbName="SourcingSystemDB",this.version=1,this.db=null}}let i=new s},5695:(e,a,t)=>{"use strict";var s=t(8999);t.o(s,"usePathname")&&t.d(a,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}})},5714:()=>{},7726:(e,a,t)=>{Promise.resolve().then(t.bind(t,8484))},8484:(e,a,t)=>{"use strict";t.d(a,{default:()=>c});var s=t(5155),i=t(5695),d=t(2115),n=t(2501);t(5714);let l=(0,d.memo)(e=>{var a,t,i,l,c,r,o,m,u,h,b,v,x,j,N,p,f,g,D,y,w,C,A,k,S,I,E,R,F,L,T,U,P,B,O,M,$,V,W,Q,q,Y,_,z,G,J,H,K;let{show:X,entry:Z,onClose:ee,currentUser:ea,isAdmin:et,isSubAdmin:es,onEdit:ei,onDelete:ed}=e,[en,el]=(0,d.useState)(0);if(!X||!Z)return null;let ec=(null==(a=Z.sourcingData)?void 0:a.vendors)||[],er=ec[en],eo=ec.length,em=async(e,a)=>{try{console.log("\uD83D\uDCE5 Downloading attachment:",e);let t="",s=e.name||"".concat(a,"_attachment");if("string"==typeof e){let a=await n.A.getAttachment(e);if(a&&a.file)t=URL.createObjectURL(a.file),s=a.name||s;else throw Error("File not found in IndexedDB")}else if(e.file instanceof File)t=URL.createObjectURL(e.file),s=e.file.name||s;else if(e.file instanceof Blob)t=URL.createObjectURL(e.file),s=e.name||s;else if(e.file&&"object"==typeof e.file){let a=new Blob([e.file],{type:e.type||"application/octet-stream"});t=URL.createObjectURL(a),s=e.name||s}else if(e.data){let a,s=e.type||"application/octet-stream";if("string"==typeof e.data)try{let t=e.data.includes(",")?e.data.split(",")[1]:e.data,s=atob(t),i=new Uint8Array(s.length);for(let e=0;e<s.length;e++)i[e]=s.charCodeAt(e);a=i}catch(t){a=new TextEncoder().encode(e.data),s="text/plain"}else a=e.data instanceof ArrayBuffer?new Uint8Array(e.data):e.data instanceof Uint8Array?e.data:new TextEncoder().encode(String(e.data));let i=new Blob([a],{type:s});t=URL.createObjectURL(i)}else if(e.url)t=e.url;else throw Error("No valid file data found");let i=document.createElement("a");i.href=t,i.download=s,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),t.startsWith("blob:")&&setTimeout(()=>URL.revokeObjectURL(t),1e3),alert("\uD83D\uDCE5 Downloaded: ".concat(s))}catch(a){console.error("❌ Error downloading file:",a),alert("❌ Error downloading file: ".concat(e.name||"Unknown","\n\nError: ").concat(a.message))}},eu=async(e,a)=>{try{console.log("\uD83D\uDC41️ Previewing attachment:",e);let t="",s=e.name||"".concat(a,"_attachment"),i=e.type||"application/pdf";if(e.url)t=e.url,s=e.name||s,i=e.type||"application/pdf";else if("string"==typeof e){let a=await n.A.getAttachment(e);if(a&&a.file)i=a.file.type||a.type||"application/pdf",t=URL.createObjectURL(a.file),s=a.name||s;else throw Error("File not found in IndexedDB")}else if(e.file instanceof File)i=e.file.type||"application/pdf",t=URL.createObjectURL(e.file),s=e.file.name||s;else if(e.file instanceof Blob)i=e.file.type||e.type||"application/pdf",t=URL.createObjectURL(e.file),s=e.name||s;else if(e.file&&"object"==typeof e.file){i=e.type||"application/pdf";let a=new Blob([e.file],{type:i});t=URL.createObjectURL(a),s=e.name||s}else if(e.data){let a;if(i=e.type||"application/pdf","string"==typeof e.data)try{let t=e.data.includes(",")?e.data.split(",")[1]:e.data,s=atob(t),i=new Uint8Array(s.length);for(let e=0;e<s.length;e++)i[e]=s.charCodeAt(e);a=i}catch(t){a=new TextEncoder().encode(e.data),i="text/plain"}else e.data instanceof ArrayBuffer?a=new Uint8Array(e.data):e.data instanceof Uint8Array?a=e.data:(a=new TextEncoder().encode(String(e.data)),i="text/plain");let s=new Blob([a],{type:i});t=URL.createObjectURL(s)}else throw Error("No valid file data found");if(console.log("\uD83D\uDD0D Preview URL created:",t),console.log("\uD83D\uDCC4 File type:",i),"application/pdf"===i){let e=window.open(t,"_blank","width=1000,height=800,scrollbars=yes,resizable=yes");if(!e){alert("❌ Preview blocked by browser popup blocker.\n\nPlease allow popups for this site and try again."),t.startsWith("blob:")&&URL.revokeObjectURL(t);return}e.document.title="Preview: ".concat(s),t.startsWith("blob:")&&setTimeout(()=>{try{URL.revokeObjectURL(t)}catch(e){console.warn("Could not revoke blob URL:",e)}},3e4)}else if(i.startsWith("image/")){let e=window.open("","_blank","width=800,height=600,scrollbars=yes,resizable=yes");if(!e){alert("❌ Preview blocked by browser popup blocker.\n\nPlease allow popups for this site and try again."),t.startsWith("blob:")&&URL.revokeObjectURL(t);return}e.document.write("\n                    <!DOCTYPE html>\n                    <html>\n                    <head>\n                        <title>Preview: ".concat(s,'</title>\n                        <style>\n                            body { margin: 0; padding: 20px; text-align: center; background: #f0f0f0; }\n                            img { max-width: 100%; height: auto; border: 1px solid #ddd; }\n                        </style>\n                    </head>\n                    <body>\n                        <img src="').concat(t,'" alt="').concat(s,'">\n                    </body>\n                    </html>\n                ')),t.startsWith("blob:")&&setTimeout(()=>{try{URL.revokeObjectURL(t)}catch(e){console.warn("Could not revoke blob URL:",e)}},3e4)}else if(i.startsWith("text/")){let e=window.open("","_blank","width=800,height=600,scrollbars=yes,resizable=yes");if(!e){alert("❌ Preview blocked by browser popup blocker.\n\nPlease allow popups for this site and try again."),t.startsWith("blob:")&&URL.revokeObjectURL(t);return}fetch(t).then(e=>e.text()).then(a=>{e.document.write("\n                            <!DOCTYPE html>\n                            <html>\n                            <head>\n                                <title>Preview: ".concat(s,"</title>\n                                <style>\n                                    body { margin: 0; padding: 20px; font-family: monospace; background: #f8f8f8; }\n                                    pre { white-space: pre-wrap; word-wrap: break-word; }\n                                </style>\n                            </head>\n                            <body>\n                                <pre>").concat(a,"</pre>\n                            </body>\n                            </html>\n                        "))}).catch(a=>{e.document.write('\n                            <!DOCTYPE html>\n                            <html>\n                            <head><title>Error</title></head>\n                            <body style="padding: 20px; font-family: Arial;">\n                                <h3>Error loading file</h3>\n                                <p>'.concat(a.message,"</p>\n                            </body>\n                            </html>\n                        "))}),t.startsWith("blob:")&&setTimeout(()=>{try{URL.revokeObjectURL(t)}catch(e){console.warn("Could not revoke blob URL:",e)}},3e4)}else window.confirm('❓ File "'.concat(s,'" cannot be previewed in browser.\n\nFile type: ').concat(i,"\n\nWould you like to download it instead?"))&&await em(e,a),t.startsWith("blob:")&&URL.revokeObjectURL(t)}catch(a){console.error("❌ Error previewing file:",a),alert("❌ Error previewing file: ".concat(e.name||"Unknown","\n\nError: ").concat(a.message,"\n\nTry downloading the file instead."))}},eh=async(e,a)=>{var t,s;if(!(null==(t=e.sourcingInfo)?void 0:t.attachments)||0===e.sourcingInfo.attachments.length)return void alert("\uD83D\uDCED No attachments found for this vendor.");let i=(null==(s=e.sourcingInfo)?void 0:s.vendorName)||"Vendor_".concat(a+1);try{for(let a=0;a<e.sourcingInfo.attachments.length;a++){let t=e.sourcingInfo.attachments[a];setTimeout(async()=>{await em(t,i)},1e3*a)}alert("\uD83D\uDCE5 Downloading ".concat(e.sourcingInfo.attachments.length," files from ").concat(i,"..."))}catch(e){console.error("❌ Error downloading all files:",e),alert("❌ Error downloading files from ".concat(i,": ").concat(e.message))}};return(0,s.jsx)("div",{className:"submitted-data-entry-details-modal-overlay",children:(0,s.jsxs)("div",{className:"submitted-data-entry-details-modal",children:[(0,s.jsxs)("div",{className:"submitted-data-entry-details-modal-header",children:[(0,s.jsxs)("h3",{children:["\uD83D\uDCCB Complete Entry Details - ",Z.archiveId||Z.id]}),(0,s.jsxs)("div",{className:"submitted-data-modal-header-actions",children:[(et||es)&&(0,s.jsx)("button",{className:"submitted-data-btn-edit-entry",onClick:()=>ei(Z),title:"Edit Entry",children:"✏️ Edit"}),et&&(0,s.jsx)("button",{className:"submitted-data-btn-delete-entry",onClick:()=>ed(Z),title:"Delete Entry",children:"\uD83D\uDDD1️ Delete"}),(0,s.jsx)("button",{className:"submitted-data-modal-close-btn",onClick:ee,children:"\xd7"})]})]}),(0,s.jsxs)("div",{className:"submitted-data-entry-details-modal-body",children:[(0,s.jsxs)("div",{className:"submitted-data-modal-section",children:[(0,s.jsx)("h4",{children:"\uD83D\uDDC2️ Archive Information"}),(0,s.jsxs)("div",{className:"submitted-data-info-grid",children:[(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Archive ID:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.archiveId||Z.id})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"QMS ID:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.id})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Submitted At:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.submittedToArchiveAt||Z.archivedAt||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Submitted By:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.submittedToArchiveBy||Z.archivedBy||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Final Status:"}),(0,s.jsx)("span",{className:"submitted-data-value submitted-data-status-approved",children:"✅ Submitted"})]})]})]}),(0,s.jsxs)("div",{className:"submitted-data-modal-section",children:[(0,s.jsx)("h4",{children:"\uD83D\uDCCB Original QMS Information"}),(0,s.jsxs)("div",{className:"submitted-data-info-grid",children:[(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Entry ID:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.id})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Bid Title:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.bidTitle||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Bid Number:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.bidNumber||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Portal:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.portalName||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Category:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.category||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Quantity:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.quantity||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Sourcer:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.sourcerName||Z.hunterName||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Due Date:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.dueDate||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Created:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.dateCreated||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Assigned By:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.assignedBy||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Contact:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.contactName||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Email:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.email||"N/A"})]}),(Z.sourcingRemarks||Z.huntingRemarks)&&(0,s.jsxs)("div",{className:"submitted-data-info-item submitted-data-full-width",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Original Remarks:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.sourcingRemarks||Z.huntingRemarks})]})]})]}),"approval_approved"===Z.status&&Z.approvalRemarks&&(0,s.jsxs)("div",{className:"submitted-data-modal-section",children:[(0,s.jsx)("h4",{children:"✅ Approval Information"}),(0,s.jsxs)("div",{className:"submitted-data-info-grid",children:[(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Approved By:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.approvedBy||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Approved At:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.approvedAt||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item submitted-data-full-width",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Approval Remarks:"}),(0,s.jsx)("div",{className:"submitted-data-remarks-text",children:Z.approvalRemarks})]})]})]}),ec.length>0&&(0,s.jsxs)("div",{className:"submitted-data-modal-section",children:[(0,s.jsxs)("div",{className:"submitted-data-vendor-carousel-header",children:[(0,s.jsxs)("h4",{children:["\uD83C\uDFE2 Vendor Details (",eo," Vendor",eo>1?"s":"",")"]}),eo>1&&(0,s.jsxs)("div",{className:"submitted-data-vendor-navigation",children:[(0,s.jsx)("button",{className:"submitted-data-vendor-nav-btn",onClick:()=>{el(e=>Math.max(0,e-1))},disabled:0===en,children:"← Prev"}),(0,s.jsxs)("span",{className:"submitted-data-vendor-counter",children:[en+1," of ",eo]}),(0,s.jsx)("button",{className:"submitted-data-vendor-nav-btn",onClick:()=>{ec.length>0&&el(e=>Math.min(ec.length-1,e+1))},disabled:en===eo-1,children:"Next →"})]})]}),eo>1&&(0,s.jsx)("div",{className:"submitted-data-vendor-indicators",children:ec.map((e,a)=>{var t;return(0,s.jsxs)("button",{className:"submitted-data-vendor-indicator ".concat(a===en?"active":""),onClick:()=>el(a),title:"Go to ".concat((null==(t=e.sourcingInfo)?void 0:t.vendorName)||"Vendor ".concat(a+1)),children:[a===en?"●":"○",e.isPrimary&&(0,s.jsx)("span",{className:"submitted-data-primary-badge",children:"⭐"})]},a)})}),er&&(0,s.jsxs)("div",{className:"submitted-data-vendor-content",children:[(0,s.jsx)("div",{className:"submitted-data-vendor-title",children:(0,s.jsxs)("h5",{children:["\uD83D\uDCCB Vendor ",en+1,": ",(null==(t=er.sourcingInfo)?void 0:t.vendorName)||"Unknown",er.isPrimary&&(0,s.jsx)("span",{className:"submitted-data-primary-tag",children:"⭐ PRIMARY"})]})}),(0,s.jsxs)("div",{className:"submitted-data-vendor-section",children:[(0,s.jsx)("h6",{children:"\uD83D\uDCCB Sourcing Information"}),(0,s.jsxs)("div",{className:"submitted-data-vendor-fields-complete",children:[(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Vendor Name:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(i=er.sourcingInfo)?void 0:i.vendorName)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Quoted Cost:"}),(0,s.jsxs)("span",{className:"submitted-data-field-value submitted-data-cost",children:["$",(null==(l=er.sourcingInfo)?void 0:l.productServiceQuotedCost)||"0.00"]})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Website:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(c=er.sourcingInfo)?void 0:c.vendorWebsite)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field submitted-data-full-width",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Vendor Address:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(r=er.sourcingInfo)?void 0:r.vendorAddress)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Proper Quotation:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(o=er.sourcingInfo)?void 0:o.properQuotationGiven)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Proper Quotation (Vendor):"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(m=er.sourcingInfo)?void 0:m.properQuotationGivenNew)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Risk Assessment:"}),(0,s.jsx)("span",{className:"submitted-data-field-value submitted-data-risk-".concat(null==(b=er.sourcingInfo)||null==(h=b.riskAssessment)||null==(u=h.toLowerCase())?void 0:u.replace(" ","-")),children:(null==(v=er.sourcingInfo)?void 0:v.riskAssessment)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Compliance:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(x=er.sourcingInfo)?void 0:x.compliance)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"CC Accepted:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(j=er.sourcingInfo)?void 0:j.ccAccepted)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"NET Terms:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(N=er.sourcingInfo)?void 0:N.netTermsAvailable)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"CC Charges:"}),(0,s.jsxs)("span",{className:"submitted-data-field-value",children:[(null==(p=er.sourcingInfo)?void 0:p.ccCharges)||"N/A","%"]})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Specs Sheet Taken:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(f=er.sourcingInfo)?void 0:f.specsSheetTaken)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Lead Time:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(g=er.sourcingInfo)?void 0:g.leadTimeOffered)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Stock Available:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(D=er.sourcingInfo)?void 0:D.stockAvailable)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Quote Receiving Date:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(y=er.sourcingInfo)?void 0:y.quoteReceivingDate)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Quote Valid Till:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(w=er.sourcingInfo)?void 0:w.quoteValidTill)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Remaining Days:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(C=er.sourcingInfo)?void 0:C.remainingDays)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Item Same/Alternative:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(A=er.sourcingInfo)?void 0:A.itemSameAlternative)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Warranty:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(k=er.sourcingInfo)?void 0:k.warrantyPeriod)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"After Sales Support:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(S=er.sourcingInfo)?void 0:S.afterSalesSupport)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Support Period:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(I=er.sourcingInfo)?void 0:I.supportPeriod)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field submitted-data-full-width",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Warranty/Support Terms:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(E=er.sourcingInfo)?void 0:E.warrantySupportTerms)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Shipping Cost:"}),(0,s.jsxs)("span",{className:"submitted-data-field-value submitted-data-cost",children:["$",(null==(R=er.sourcingInfo)?void 0:R.estimatedShippingCost)||"0.00"]})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Applicable Taxes:"}),(0,s.jsx)("span",{className:"submitted-data-field-value",children:(null==(F=er.sourcingInfo)?void 0:F.applicableTaxes)||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-field",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Restocking Fees:"}),(0,s.jsxs)("span",{className:"submitted-data-field-value",children:[(null==(L=er.sourcingInfo)?void 0:L.restockingFees)||"N/A",(null==(T=er.sourcingInfo)?void 0:T.restockingFees)==="Yes"&&(null==(U=er.sourcingInfo)?void 0:U.restockingFeesPercentage)&&" (".concat(er.sourcingInfo.restockingFeesPercentage,"%)")]})]}),(null==(P=er.sourcingInfo)?void 0:P.remarks)&&(0,s.jsxs)("div",{className:"submitted-data-vendor-field submitted-data-full-width",children:[(0,s.jsx)("span",{className:"submitted-data-field-label",children:"Vendor Remarks:"}),(0,s.jsx)("div",{className:"submitted-data-remarks-text",children:er.sourcingInfo.remarks})]})]})]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-section",children:[(0,s.jsx)("h6",{children:"\uD83D\uDCB0 Pricing & Line Items"}),(null==(B=er.pricing)?void 0:B.lineItems)&&er.pricing.lineItems.length>0&&(0,s.jsxs)("div",{className:"submitted-data-line-items",children:[(0,s.jsxs)("div",{className:"submitted-data-line-items-header",children:[(0,s.jsx)("span",{children:"Description"}),(0,s.jsx)("span",{children:"Qty"}),(0,s.jsx)("span",{children:"Unit Price"}),(0,s.jsx)("span",{children:"Total"})]}),er.pricing.lineItems.map((e,a)=>(0,s.jsxs)("div",{className:"submitted-data-line-item-row",children:[(0,s.jsx)("span",{children:e.description||"N/A"}),(0,s.jsx)("span",{children:e.qty||"0"}),(0,s.jsxs)("span",{children:["$",e.unitPrice||"0.00"]}),(0,s.jsxs)("span",{children:["$",(e.cost||0).toFixed(2)]})]},e.id||a))]}),(0,s.jsxs)("div",{className:"submitted-data-cost-breakdown",children:[(0,s.jsxs)("div",{className:"submitted-data-breakdown-item",children:[(0,s.jsx)("span",{children:"Subtotal:"}),(0,s.jsxs)("span",{children:["$",((null==(O=er.pricing)?void 0:O.subtotal)||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"submitted-data-breakdown-item",children:[(0,s.jsx)("span",{children:"CC Charges:"}),(0,s.jsxs)("span",{children:["$",((null==(M=er.pricing)?void 0:M.ccChargesAmount)||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"submitted-data-breakdown-item",children:[(0,s.jsx)("span",{children:"Tax:"}),(0,s.jsxs)("span",{children:["$",((null==($=er.pricing)?void 0:$.taxAmount)||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"submitted-data-breakdown-item",children:[(0,s.jsx)("span",{children:"Freight:"}),(0,s.jsxs)("span",{children:["$",((null==(V=er.pricing)?void 0:V.freightLogistics)||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"submitted-data-breakdown-item",children:[(0,s.jsx)("span",{children:"Extended Warranty:"}),(0,s.jsxs)("span",{children:["$",((null==(W=er.pricing)?void 0:W.extendedWarranty)||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"submitted-data-breakdown-item",children:[(0,s.jsx)("span",{children:"Installation:"}),(0,s.jsxs)("span",{children:["$",((null==(Q=er.pricing)?void 0:Q.installation)||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"submitted-data-breakdown-item",children:[(0,s.jsx)("span",{children:"Restocking Fees:"}),(0,s.jsxs)("span",{children:["$",((null==(q=er.pricing)?void 0:q.restockingFeesAmount)||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"submitted-data-breakdown-item",children:[(0,s.jsx)("span",{children:"Other 1:"}),(0,s.jsxs)("span",{children:["$",((null==(Y=er.pricing)?void 0:Y.other1)||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"submitted-data-breakdown-item",children:[(0,s.jsx)("span",{children:"Other 2:"}),(0,s.jsxs)("span",{children:["$",((null==(_=er.pricing)?void 0:_.other2)||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"submitted-data-breakdown-item submitted-data-grand-total",children:[(0,s.jsx)("span",{children:"Grand Total:"}),(0,s.jsxs)("span",{children:["$",((null==(z=er.pricing)?void 0:z.grandTotal)||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"submitted-data-breakdown-item",children:[(0,s.jsx)("span",{children:"Discount 1:"}),(0,s.jsxs)("span",{children:["-$",((null==(G=er.pricing)?void 0:G.discount1)||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"submitted-data-breakdown-item",children:[(0,s.jsx)("span",{children:"Discount 2:"}),(0,s.jsxs)("span",{children:["-$",((null==(J=er.pricing)?void 0:J.discount2)||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"submitted-data-breakdown-item submitted-data-final-total",children:[(0,s.jsx)("span",{children:"Final Total:"}),(0,s.jsxs)("span",{children:["$",((null==(H=er.pricing)?void 0:H.finalGrandTotal)||0).toFixed(2)]})]})]})]}),(null==(K=er.sourcingInfo)?void 0:K.attachments)&&er.sourcingInfo.attachments.length>0&&(0,s.jsxs)("div",{className:"submitted-data-vendor-section",children:[(0,s.jsxs)("div",{className:"submitted-data-attachments-header",children:[(0,s.jsxs)("h6",{children:["\uD83D\uDCCE Vendor Attachments (",er.sourcingInfo.attachments.length,")"]}),(0,s.jsx)("button",{className:"submitted-data-btn-download-all",onClick:()=>eh(er,en),title:"Download all files",children:"\uD83D\uDCE5 Download All"})]}),(0,s.jsx)("div",{className:"submitted-data-attachments-list",children:er.sourcingInfo.attachments.map((e,a)=>{var t,i,d,n,l,c,r;return(0,s.jsxs)("div",{className:"submitted-data-attachment-item",children:[(0,s.jsxs)("div",{className:"submitted-data-attachment-info",children:[(0,s.jsxs)("div",{className:"submitted-data-attachment-name",children:["\uD83D\uDCC4 ",e.name||(null==(t=e.file)?void 0:t.name)||"File ".concat(a+1),(e.type||(null==(i=e.file)?void 0:i.type))&&(0,s.jsxs)("span",{className:"submitted-data-file-type",children:["(",null==(d=(e.type||(null==(n=e.file)?void 0:n.type)).split("/")[1])?void 0:d.toUpperCase(),")"]})]}),(0,s.jsx)("div",{className:"submitted-data-attachment-size",children:e.size||(null==(l=e.file)?void 0:l.size)||"Unknown size"})]}),(0,s.jsxs)("div",{className:"submitted-data-attachment-actions",children:[(0,s.jsx)("button",{className:"submitted-data-btn-preview",onClick:()=>{var a;return eu(e,(null==(a=er.sourcingInfo)?void 0:a.vendorName)||"Vendor ".concat(en+1))},title:"Preview ".concat(e.name||(null==(c=e.file)?void 0:c.name)||"file"),children:"\uD83D\uDC41️"}),(0,s.jsx)("button",{className:"submitted-data-btn-download",onClick:()=>{var a;return em(e,(null==(a=er.sourcingInfo)?void 0:a.vendorName)||"Vendor ".concat(en+1))},title:"Download ".concat(e.name||(null==(r=e.file)?void 0:r.name)||"file"),children:"\uD83D\uDCE5"})]})]},a)})})]})]})]}),Z.submissionCalculations&&(0,s.jsxs)("div",{className:"submitted-data-modal-section",children:[(0,s.jsx)("h4",{children:"\uD83D\uDCCA Submission Details & Calculations"}),(0,s.jsxs)("div",{className:"submitted-data-submission-calculations",children:[(0,s.jsxs)("div",{className:"submitted-data-calc-row",children:[(0,s.jsxs)("div",{className:"submitted-data-calc-item",children:[(0,s.jsx)("span",{className:"submitted-data-calc-label",children:"\uD83D\uDCC5 Submission Date:"}),(0,s.jsx)("span",{className:"submitted-data-calc-value",children:Z.submissionCalculations.submissionDate||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-calc-item",children:[(0,s.jsx)("span",{className:"submitted-data-calc-label",children:"\uD83D\uDC64 Assigned Person:"}),(0,s.jsx)("span",{className:"submitted-data-calc-value",children:Z.submissionCalculations.assignedPerson||"N/A"})]})]}),(0,s.jsxs)("div",{className:"submitted-data-calc-row",children:[(0,s.jsxs)("div",{className:"submitted-data-calc-item",children:[(0,s.jsx)("span",{className:"submitted-data-calc-label",children:"\uD83D\uDCB0 Vendor Cost:"}),(0,s.jsxs)("span",{className:"submitted-data-calc-value submitted-data-cost",children:["$",(Z.submissionCalculations.vendorCost||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"submitted-data-calc-item",children:[(0,s.jsx)("span",{className:"submitted-data-calc-label",children:"\uD83D\uDE9A Shipping Cost:"}),(0,s.jsxs)("span",{className:"submitted-data-calc-value",children:["$",(Z.submissionCalculations.shippingCost||0).toFixed(2)]})]})]}),(0,s.jsxs)("div",{className:"submitted-data-calc-row",children:[(0,s.jsxs)("div",{className:"submitted-data-calc-item",children:[(0,s.jsx)("span",{className:"submitted-data-calc-label",children:"\uD83D\uDCB3 CC Cost (%):"}),(0,s.jsxs)("span",{className:"submitted-data-calc-value",children:[(Z.submissionCalculations.ccCostPercent||0).toFixed(2),"%"]})]}),(0,s.jsxs)("div",{className:"submitted-data-calc-item",children:[(0,s.jsx)("span",{className:"submitted-data-calc-label",children:"\uD83D\uDCB3 CC Cost ($):"}),(0,s.jsxs)("span",{className:"submitted-data-calc-value",children:["$",(Z.submissionCalculations.ccCostAmount||0).toFixed(2)]})]})]}),(0,s.jsxs)("div",{className:"submitted-data-calc-row",children:[(0,s.jsxs)("div",{className:"submitted-data-calc-item",children:[(0,s.jsx)("span",{className:"submitted-data-calc-label",children:"\uD83D\uDCB5 Total Cost:"}),(0,s.jsxs)("span",{className:"submitted-data-calc-value submitted-data-total",children:["$",(Z.submissionCalculations.totalCost||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"submitted-data-calc-item",children:[(0,s.jsx)("span",{className:"submitted-data-calc-label",children:"\uD83D\uDCCA 1% Vendor Cost:"}),(0,s.jsxs)("span",{className:"submitted-data-calc-value",children:["$",(Z.submissionCalculations.onePercentVendorCost||0).toFixed(2)]})]})]}),(0,s.jsxs)("div",{className:"submitted-data-calc-row",children:[(0,s.jsxs)("div",{className:"submitted-data-calc-item",children:[(0,s.jsx)("span",{className:"submitted-data-calc-label",children:"\uD83D\uDCC8 Profit (%):"}),(0,s.jsxs)("span",{className:"submitted-data-calc-value",children:[(Z.submissionCalculations.profitPercent||0).toFixed(2),"%"]})]}),(0,s.jsxs)("div",{className:"submitted-data-calc-item",children:[(0,s.jsx)("span",{className:"submitted-data-calc-label",children:"\uD83D\uDCB2 Profit ($):"}),(0,s.jsxs)("span",{className:"submitted-data-calc-value",children:["$",(Z.submissionCalculations.profitAmount||0).toFixed(2)]})]})]}),(0,s.jsxs)("div",{className:"submitted-data-calc-row",children:[(0,s.jsxs)("div",{className:"submitted-data-calc-item",children:[(0,s.jsx)("span",{className:"submitted-data-calc-label",children:"\uD83D\uDC8E Total Profit:"}),(0,s.jsxs)("span",{className:"submitted-data-calc-value submitted-data-total",children:["$",(Z.submissionCalculations.totalProfitAmount||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"submitted-data-calc-item",children:[(0,s.jsx)("span",{className:"submitted-data-calc-label",children:"\uD83C\uDFDB️ Tax Amount:"}),(0,s.jsxs)("span",{className:"submitted-data-calc-value",children:["$",(Z.submissionCalculations.taxAmount||0).toFixed(2)]})]})]}),(0,s.jsx)("div",{className:"submitted-data-calc-row",children:(0,s.jsxs)("div",{className:"submitted-data-calc-item submitted-data-full-width",children:[(0,s.jsx)("span",{className:"submitted-data-calc-label",children:"\uD83C\uDFAF Submitted with Margin:"}),(0,s.jsxs)("span",{className:"submitted-data-calc-value submitted-data-final-amount",children:["$",(Z.submissionCalculations.submittedWithMargin||0).toFixed(2)]})]})})]})]}),Z.submissionAttachments&&Z.submissionAttachments.length>0&&(0,s.jsxs)("div",{className:"submitted-data-modal-section",children:[(0,s.jsx)("div",{className:"submitted-data-attachments-header",children:(0,s.jsxs)("h4",{children:["\uD83D\uDCCE Submission Attachments (",Z.submissionAttachments.length,")"]})}),(0,s.jsx)("div",{className:"submitted-data-attachments-list",children:Z.submissionAttachments.map((e,a)=>{var t;return(0,s.jsxs)("div",{className:"submitted-data-attachment-item",children:[(0,s.jsxs)("div",{className:"submitted-data-attachment-info",children:[(0,s.jsxs)("div",{className:"submitted-data-attachment-name",children:["\uD83D\uDCC4 ",e.name,e.type&&(0,s.jsxs)("span",{className:"submitted-data-file-type",children:["(",null==(t=e.type.split("/")[1])?void 0:t.toUpperCase(),")"]})]}),(0,s.jsx)("div",{className:"submitted-data-attachment-size",children:e.size})]}),(0,s.jsxs)("div",{className:"submitted-data-attachment-actions",children:[(0,s.jsx)("button",{className:"submitted-data-btn-preview",onClick:()=>eu(e,"Submission"),title:"Preview ".concat(e.name),children:"\uD83D\uDC41️"}),(0,s.jsx)("button",{className:"submitted-data-btn-download",onClick:()=>em(e,"Submission"),title:"Download ".concat(e.name),children:"\uD83D\uDCE5"})]})]},e.id||a)})})]}),(0,s.jsxs)("div",{className:"submitted-data-modal-section",children:[(0,s.jsx)("h4",{children:"\uD83D\uDCE4 Final Submission Information"}),(0,s.jsxs)("div",{className:"submitted-data-info-grid",children:[(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Submitted By:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.finalSubmissionBy||"N/A"})]}),(0,s.jsxs)("div",{className:"submitted-data-info-item",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Submission Date:"}),(0,s.jsx)("span",{className:"submitted-data-value",children:Z.finalSubmissionAt||"N/A"})]}),Z.finalSubmissionRemarks&&(0,s.jsxs)("div",{className:"submitted-data-info-item submitted-data-full-width",children:[(0,s.jsx)("span",{className:"submitted-data-label",children:"Special Submission Remarks:"}),(0,s.jsx)("div",{className:"submitted-data-remarks-text",children:Z.finalSubmissionRemarks})]})]})]}),Z.workflowStages&&(0,s.jsxs)("div",{className:"submitted-data-modal-section",children:[(0,s.jsx)("h4",{children:"\uD83D\uDD04 Workflow History"}),(0,s.jsx)("div",{className:"submitted-data-workflow-stages",children:Z.workflowStages.map((e,a)=>(0,s.jsxs)("div",{className:"submitted-data-workflow-stage",children:[(0,s.jsxs)("div",{className:"submitted-data-stage-icon",children:["hunting"===e.stage&&"\uD83C\uDFAF","sourcing"===e.stage&&"\uD83D\uDD0D","approval"===e.stage&&"✅","submission"===e.stage&&"\uD83D\uDCE4"]}),(0,s.jsxs)("div",{className:"submitted-data-stage-info",children:[(0,s.jsx)("div",{className:"submitted-data-stage-name",children:e.stage.charAt(0).toUpperCase()+e.stage.slice(1)}),(0,s.jsxs)("div",{className:"submitted-data-stage-details",children:["Completed by: ",e.completedBy," at ",e.completedAt]})]})]},a))})]})]}),(0,s.jsx)("div",{className:"submitted-data-entry-details-modal-footer",children:(0,s.jsx)("button",{className:"submitted-data-btn-close-modal",onClick:ee,children:"Close"})})]})})}),c=()=>{(0,i.useRouter)();let[e,a]=(0,d.useState)([]),[t,c]=(0,d.useState)(!0),[r,o]=(0,d.useState)(null),[m,u]=(0,d.useState)(null),[h,b]=(0,d.useState)(""),[v,x]=(0,d.useState)(null),[j,N]=(0,d.useState)(!1),p="Mike469-a11y";(0,d.useEffect)(()=>{f(),n.A.initDB().catch(e=>{console.error("Failed to initialize IndexedDB:",e)})},[]);let f=()=>{try{console.log("\uD83D\uDCC2 Loading submitted entries from localStorage...");let e=localStorage.getItem("submittedDataEntries");if(e){let t=JSON.parse(e);console.log("\uD83D\uDCE5 Found ".concat(t.length," entries in localStorage"));let s=[],i=new Set,d=[];t.sort((e,a)=>{let t=new Date(e.submittedToArchiveAt||e.archivedAt||e.finalSubmissionAt||"1970-01-01");return new Date(a.submittedToArchiveAt||a.archivedAt||a.finalSubmissionAt||"1970-01-01")-t}).forEach((e,a)=>{let t=e.id;if(!t)return void console.warn("⚠️ Entry at index ".concat(a," has no QMS ID:"),e);i.has(t)?(d.push(e),console.warn("❌ DUPLICATE QMS ID REMOVED: ".concat(t," (").concat(e.bidTitle||"No title",")"))):(i.add(t),s.push(e),console.log("✅ Keeping QMS ID: ".concat(t," (").concat(e.bidTitle||"No title",")")))}),d.length>0&&(console.log("\uD83D\uDD27 REMOVING ".concat(d.length," DUPLICATE ENTRIES:")),d.forEach(e=>{console.log("   - QMS ID: ".concat(e.id," | Title: ").concat(e.bidTitle||"No title"))}),localStorage.setItem("submittedDataEntries",JSON.stringify(s)),console.log("\uD83D\uDCBE Updated localStorage with ".concat(s.length," unique entries")),d.length>0&&setTimeout(()=>{alert("\uD83D\uDD27 DUPLICATE CLEANUP\n\nRemoved ".concat(d.length," duplicate entries with same QMS IDs.\n\n✅ Archive now contains ").concat(s.length," unique entries."))},1e3)),console.log("\uD83D\uDCCA Final result: ".concat(s.length," unique entries loaded")),a(s)}else console.log("\uD83D\uDCED No submitted entries found in localStorage"),a([])}catch(e){console.error("❌ Error loading submitted entries:",e),a([])}finally{c(!1)}},g=(0,d.useMemo)(()=>{console.log("\uD83D\uDCC5 Calculating available years from",e.length,"entries");let a=new Set;e.forEach(e=>{let t=e.submittedToArchiveAt||e.archivedAt||e.finalSubmissionAt;if(t){let s=new Date(t).getFullYear();a.add(s),console.log("  - Entry ".concat(e.id,": ").concat(t," → Year ").concat(s))}else console.warn("  - Entry ".concat(e.id,": No submission date found"))});let t=Array.from(a).sort((e,a)=>a-e);return console.log("\uD83D\uDCC5 Available years:",t),t},[e]),D=(0,d.useMemo)(()=>{if(!r)return[];console.log("\uD83D\uDCC5 Calculating available months for year",r);let a=new Set;e.forEach(e=>{let t=e.submittedToArchiveAt||e.archivedAt||e.finalSubmissionAt;if(t){let s=new Date(t);s.getFullYear()===r&&(a.add(s.getMonth()),console.log("  - Entry ".concat(e.id,": Month ").concat(s.getMonth())))}});let t=Array.from(a).sort((e,a)=>a-e);return console.log("\uD83D\uDCC5 Available months for",r,":",t),t},[e,r]),y=(0,d.useMemo)(()=>{if(!r||null===m)return[];console.log("\uD83D\uDD0D Filtering entries for",r,"month",m,"search:",h);let a=e.filter(e=>{var a,t,s,i,d,n,l;let c=e.submittedToArchiveAt||e.archivedAt||e.finalSubmissionAt;if(!c)return!1;let o=new Date(c),u=o.getFullYear()===r,b=o.getMonth()===m,v=!h||(null==(a=e.bidTitle)?void 0:a.toLowerCase().includes(h.toLowerCase()))||(null==(t=e.bidNumber)?void 0:t.toLowerCase().includes(h.toLowerCase()))||(null==(s=e.portalName)?void 0:s.toLowerCase().includes(h.toLowerCase()))||(null==(i=e.sourcerName)?void 0:i.toLowerCase().includes(h.toLowerCase()))||(null==(d=e.hunterName)?void 0:d.toLowerCase().includes(h.toLowerCase()))||(null==(n=e.id)?void 0:n.toLowerCase().includes(h.toLowerCase()))||(null==(l=e.archiveId)?void 0:l.toLowerCase().includes(h.toLowerCase())),x=u&&b&&v;return x&&console.log("✅ Entry matches: ".concat(e.id," - ").concat(e.bidTitle)),x}).sort((e,a)=>{let t=new Date(e.submittedToArchiveAt||e.archivedAt||e.finalSubmissionAt);return new Date(a.submittedToArchiveAt||a.archivedAt||a.finalSubmissionAt)-t});return console.log("\uD83D\uDD0D Filtered to",a.length,"entries"),a},[e,r,m,h]),w=e=>{console.log("✏️ Edit entry requested:",e.id),alert("Edit functionality for entry ".concat(e.id," - Coming soon!"))},C=async e=>{if(console.log("\uD83D\uDDD1️ Delete entry requested:",e.id),window.confirm("Are you sure you want to permanently delete archived entry ".concat(e.archiveId||e.id,"?\n\nThis action cannot be undone!")))try{let a=localStorage.getItem("submittedDataEntries");if(a){let t=JSON.parse(a).filter(a=>a.id!==e.id);localStorage.setItem("submittedDataEntries",JSON.stringify(t)),f(),N(!1),console.log("✅ Entry deleted:",e.id),alert("✅ Entry ".concat(e.archiveId||e.id," has been permanently deleted from the archive."))}}catch(e){console.error("❌ Error deleting entry:",e),alert("❌ Error deleting entry. Please try again.")}},A=e=>["January","February","March","April","May","June","July","August","September","October","November","December"][e];return t?(0,s.jsx)("div",{className:"submitted-data-container",children:(0,s.jsxs)("div",{className:"submitted-data-loading-container",children:[(0,s.jsx)("div",{className:"submitted-data-loading-spinner"}),(0,s.jsx)("p",{children:"Loading submitted data..."})]})}):(console.log("\uD83C\uDFA8 Rendering SubmittedData component"),console.log("\uD83D\uDCCA Current state:",{entriesCount:e.length,selectedYear:r,selectedMonth:m,searchTerm:h,filteredCount:y.length}),(0,s.jsxs)("div",{className:"submitted-data-container",children:[(0,s.jsx)(l,{show:j,entry:v,onClose:()=>N(!1),currentUser:p,isAdmin:!0,isSubAdmin:!1,onEdit:w,onDelete:C}),(0,s.jsxs)("div",{className:"submitted-data-header",children:[(0,s.jsxs)("div",{className:"submitted-data-header-left",children:[(0,s.jsx)("h1",{children:"\uD83D\uDDC2️ Submitted Data Archive"}),(0,s.jsx)("p",{children:"Permanent archive of all submitted entries organized by date"})]}),(0,s.jsx)("div",{className:"submitted-data-header-right",children:(0,s.jsxs)("div",{className:"submitted-data-user-info",children:[(0,s.jsxs)("span",{children:["Current User: ",(0,s.jsx)("strong",{children:p})]}),(0,s.jsx)("span",{className:"submitted-data-current-time",children:"2025-08-01 20:14:45"}),(0,s.jsxs)("span",{className:"submitted-data-user-role",children:["Role: ",(0,s.jsx)("strong",{children:"\uD83D\uDC51 Admin"})]})]})})]}),(0,s.jsxs)("div",{className:"submitted-data-archive-navigation",children:[(0,s.jsx)("button",{className:"submitted-data-nav-item ".concat(r?"":"submitted-data-active"),onClick:()=>{console.log("\uD83D\uDD19 Back to years"),o(null),u(null),b("")},children:"\uD83D\uDDD3️ Years"}),r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"submitted-data-nav-separator",children:"→"}),(0,s.jsxs)("button",{className:"submitted-data-nav-item ".concat(r&&null===m?"submitted-data-active":""),onClick:()=>{console.log("\uD83D\uDD19 Back to months"),u(null),b("")},children:["\uD83D\uDCC5 ",r," - Months"]})]}),r&&null!==m&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"submitted-data-nav-separator",children:"→"}),(0,s.jsxs)("span",{className:"submitted-data-nav-item submitted-data-active",children:["\uD83D\uDCCB ",A(m)," ",r," - Entries"]})]})]}),(0,s.jsxs)("div",{className:"submitted-data-content",children:[!r&&(0,s.jsxs)("div",{className:"submitted-data-year-selection-view",children:[(0,s.jsxs)("div",{className:"submitted-data-section-header",children:[(0,s.jsx)("h2",{children:"\uD83D\uDCCA Archive Overview"}),(0,s.jsxs)("div",{className:"submitted-data-archive-stats",children:[(0,s.jsxs)("div",{className:"submitted-data-stat-item",children:[(0,s.jsx)("span",{className:"submitted-data-stat-number",children:e.length}),(0,s.jsx)("span",{className:"submitted-data-stat-label",children:"Total Entries"})]}),(0,s.jsxs)("div",{className:"submitted-data-stat-item",children:[(0,s.jsx)("span",{className:"submitted-data-stat-number",children:g.length}),(0,s.jsx)("span",{className:"submitted-data-stat-label",children:"Years"})]})]})]}),0===g.length?(0,s.jsxs)("div",{className:"submitted-data-no-data-state",children:[(0,s.jsx)("div",{className:"submitted-data-no-data-icon",children:"\uD83D\uDCED"}),(0,s.jsx)("h3",{children:"No Submitted Data Found"}),(0,s.jsx)("p",{children:"No entries have been submitted to the archive yet."}),(0,s.jsx)("p",{className:"submitted-data-help-text",children:"Entries will appear here once they are submitted from the Submission Dashboard."})]}):(0,s.jsx)("div",{className:"submitted-data-years-grid",children:g.map(a=>{let t=e.filter(e=>{let t=e.submittedToArchiveAt||e.archivedAt||e.finalSubmissionAt;return t&&new Date(t).getFullYear()===a}).length;return console.log("\uD83D\uDCC5 Year ".concat(a,": ").concat(t," entries")),(0,s.jsxs)("div",{className:"submitted-data-year-card",onClick:()=>(e=>{console.log("\uD83D\uDCC5 Year selected:",e),o(e),u(null),b("")})(a),children:[(0,s.jsxs)("div",{className:"submitted-data-year-card-header",children:[(0,s.jsx)("h3",{children:a}),(0,s.jsxs)("div",{className:"submitted-data-year-entry-count",children:[t," entries"]})]}),(0,s.jsx)("div",{className:"submitted-data-year-card-footer",children:(0,s.jsx)("span",{children:"Click to view months →"})})]},a)})})]}),r&&null===m&&(0,s.jsxs)("div",{className:"submitted-data-month-selection-view",children:[(0,s.jsx)("div",{className:"submitted-data-section-header",children:(0,s.jsxs)("h2",{children:["\uD83D\uDCC5 ",r," - Select Month"]})}),(0,s.jsx)("div",{className:"submitted-data-months-grid",children:D.map(a=>{let t=((a,t)=>{let s=e.filter(e=>{let s=e.submittedToArchiveAt||e.archivedAt||e.finalSubmissionAt;if(!s)return!1;let i=new Date(s);return i.getFullYear()===a&&i.getMonth()===t}).length;return console.log("\uD83D\uDCCA Month ".concat(t," (").concat(A(t),") in ").concat(a,": ").concat(s," entries")),s})(r,a);return(0,s.jsxs)("div",{className:"submitted-data-month-card",onClick:()=>(e=>{console.log("\uD83D\uDCC5 Month selected:",e),u(e)})(a),children:[(0,s.jsxs)("div",{className:"submitted-data-month-card-header",children:[(0,s.jsx)("h3",{children:A(a)}),(0,s.jsxs)("div",{className:"submitted-data-month-entry-count",children:[t," entries"]})]}),(0,s.jsx)("div",{className:"submitted-data-month-card-footer",children:(0,s.jsx)("span",{children:"Click to view entries →"})})]},a)})})]}),r&&null!==m&&(0,s.jsxs)("div",{className:"submitted-data-entries-view",children:[(0,s.jsxs)("div",{className:"submitted-data-section-header",children:[(0,s.jsxs)("h2",{children:["\uD83D\uDCCB ",A(m)," ",r," - Submitted Entries"]}),(0,s.jsxs)("div",{className:"submitted-data-entries-controls",children:[(0,s.jsx)("div",{className:"submitted-data-search-group",children:(0,s.jsx)("input",{type:"text",placeholder:"Search by QMS ID, archive ID, bid title, sourcer...",value:h,onChange:e=>b(e.target.value),className:"submitted-data-search-input"})}),(0,s.jsxs)("div",{className:"submitted-data-entries-count",children:[y.length," entries found"]})]})]}),0===y.length?(0,s.jsxs)("div",{className:"submitted-data-no-entries-state",children:[(0,s.jsx)("div",{className:"submitted-data-no-entries-icon",children:"\uD83D\uDCED"}),(0,s.jsx)("h3",{children:"No Entries Found"}),(0,s.jsx)("p",{children:h?'No entries match your search "'.concat(h,'"'):"No entries found for ".concat(A(m)," ").concat(r)})]}):(0,s.jsxs)("div",{className:"submitted-data-entries-table",children:[(0,s.jsxs)("div",{className:"submitted-data-table-header",children:[(0,s.jsx)("div",{className:"submitted-data-header-cell",children:"Entry Info"}),(0,s.jsx)("div",{className:"submitted-data-header-cell",children:"Submission Details"}),(0,s.jsx)("div",{className:"submitted-data-header-cell",children:"Vendor Info"}),(0,s.jsx)("div",{className:"submitted-data-header-cell",children:"Actions"})]}),y.map(e=>{var a,t,i,d,n,l,c,r,o,m,u;let h=(null==(t=e.sourcingData)||null==(a=t.vendors)?void 0:a.find(e=>e.isPrimary))||(null==(d=e.sourcingData)||null==(i=d.vendors)?void 0:i[0]),b=(null==h||null==(n=h.pricing)?void 0:n.finalGrandTotal)||0,v=(null==(l=e.submissionCalculations)?void 0:l.submittedWithMargin)||0;return(0,s.jsxs)("div",{className:"submitted-data-table-row",children:[(0,s.jsxs)("div",{className:"submitted-data-cell submitted-data-entry-info",children:[(0,s.jsxs)("div",{className:"submitted-data-entry-ids",children:[(0,s.jsxs)("div",{className:"submitted-data-qms-id",children:["QMS: ",e.id]}),(0,s.jsxs)("div",{className:"submitted-data-archive-id",children:["Archive: ",e.archiveId||e.id]})]}),(0,s.jsx)("div",{className:"submitted-data-bid-title",children:e.bidTitle||"N/A"}),(0,s.jsxs)("div",{className:"submitted-data-bid-details",children:[(0,s.jsxs)("span",{children:["#",e.bidNumber]}),(0,s.jsx)("span",{children:e.portalName})]}),(0,s.jsxs)("div",{className:"submitted-data-sourcer-info",children:["\uD83D\uDC64 ",e.sourcerName||e.hunterName||"N/A"]})]}),(0,s.jsxs)("div",{className:"submitted-data-cell submitted-data-submission-details",children:[(0,s.jsxs)("div",{className:"submitted-data-submission-date",children:["\uD83D\uDCC5 ",e.submittedToArchiveAt||e.archivedAt||"N/A"]}),(0,s.jsxs)("div",{className:"submitted-data-submission-by",children:["\uD83D\uDC64 ",e.submittedToArchiveBy||e.archivedBy||"N/A"]}),(0,s.jsx)("div",{className:"submitted-data-submission-status",children:(0,s.jsx)("span",{className:"submitted-data-status-badge submitted-data-submitted",children:"✅ Submitted"})}),v>0&&(0,s.jsxs)("div",{className:"submitted-data-final-amount",children:["Final: $",v.toFixed(2)]})]}),(0,s.jsx)("div",{className:"submitted-data-cell submitted-data-vendor-info",children:h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"submitted-data-vendor-name",children:(null==(c=h.sourcingInfo)?void 0:c.vendorName)||"Unknown"}),(0,s.jsxs)("div",{className:"submitted-data-vendor-value",children:["$",b.toFixed(2)]}),(0,s.jsxs)("div",{className:"submitted-data-vendor-details",children:[(0,s.jsxs)("span",{children:[(null==(o=e.sourcingData)||null==(r=o.vendors)?void 0:r.length)||0," vendor(s)"]}),(0,s.jsxs)("span",{children:[(null==(u=h.sourcingInfo)||null==(m=u.attachments)?void 0:m.length)||0," files"]})]})]}):(0,s.jsx)("div",{className:"submitted-data-no-vendor-data",children:"No Vendor Data"})}),(0,s.jsxs)("div",{className:"submitted-data-cell submitted-data-actions",children:[(0,s.jsx)("button",{className:"submitted-data-btn-view-entry",onClick:()=>(e=>{console.log("\uD83D\uDC41️ Viewing entry:",e.id),x(e),N(!0)})(e),title:"View Complete Entry Details",children:"\uD83D\uDC41️ View"}),(0,s.jsx)("button",{className:"submitted-data-btn-edit-entry",onClick:()=>w(e),title:"Edit Entry",children:"✏️ Edit"}),(0,s.jsx)("button",{className:"submitted-data-btn-delete-entry",onClick:()=>C(e),title:"Delete Entry",children:"\uD83D\uDDD1️ Delete"})]})]},e.id)})]})]})]})]}))}}},e=>{e.O(0,[83,441,964,358],()=>e(e.s=7726)),_N_E=e.O()}]);