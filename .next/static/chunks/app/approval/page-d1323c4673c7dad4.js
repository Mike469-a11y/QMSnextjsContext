(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[12],{2501:(e,s,a)=>{"use strict";a.d(s,{A:()=>i});class n{async initDB(){return new Promise((e,s)=>{let a=indexedDB.open(this.dbName,this.version);a.onerror=()=>s(a.error),a.onsuccess=()=>{this.db=a.result,e(this.db)},a.onupgradeneeded=e=>{let s=e.target.result;if(!s.objectStoreNames.contains("attachments")){let e=s.createObjectStore("attachments",{keyPath:"id"});e.createIndex("vendorId","vendorId",{unique:!1}),e.createIndex("qmsId","qmsId",{unique:!1})}s.objectStoreNames.contains("sourcingData")||s.createObjectStore("sourcingData",{keyPath:"qmsId"})}})}async saveAttachment(e){return this.db||await this.initDB(),new Promise((s,a)=>{let n=this.db.transaction(["attachments"],"readwrite").objectStore("attachments").put(e);n.onsuccess=()=>s(n.result),n.onerror=()=>a(n.error)})}async getAttachment(e){return this.db||await this.initDB(),new Promise((s,a)=>{let n=this.db.transaction(["attachments"],"readonly").objectStore("attachments").get(e);n.onsuccess=()=>s(n.result),n.onerror=()=>a(n.error)})}async getAttachmentsByVendor(e,s){return this.db||await this.initDB(),new Promise((a,n)=>{let i=this.db.transaction(["attachments"],"readonly").objectStore("attachments").index("vendorId").getAll(e);i.onsuccess=()=>{a(i.result.filter(e=>e.qmsId===s))},i.onerror=()=>n(i.error)})}async deleteAttachment(e){return this.db||await this.initDB(),new Promise((s,a)=>{let n=this.db.transaction(["attachments"],"readwrite").objectStore("attachments").delete(e);n.onsuccess=()=>s(!0),n.onerror=()=>a(n.error)})}async saveSourcingData(e,s){return this.db||await this.initDB(),new Promise((a,n)=>{let i=this.db.transaction(["sourcingData"],"readwrite").objectStore("sourcingData").put({qmsId:e,data:s,lastUpdated:new Date});i.onsuccess=()=>a(i.result),i.onerror=()=>n(i.error)})}async getSourcingData(e){return this.db||await this.initDB(),new Promise((s,a)=>{let n=this.db.transaction(["sourcingData"],"readonly").objectStore("sourcingData").get(e);n.onsuccess=()=>{var e;return s((null==(e=n.result)?void 0:e.data)||null)},n.onerror=()=>a(n.error)})}async compressImage(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1920,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8;return new Promise(n=>{let i=document.createElement("canvas"),l=i.getContext("2d"),t=new Image;t.onload=()=>{let e=Math.min(s/t.width,s/t.height);i.width=t.width*e,i.height=t.height*e,l.drawImage(t,0,0,i.width,i.height),i.toBlob(n,"image/jpeg",a)},t.src=URL.createObjectURL(e)})}generateAttachmentId(){return"att_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}constructor(){this.dbName="SourcingSystemDB",this.version=1,this.db=null}}let i=new n},2662:()=>{},2732:(e,s,a)=>{Promise.resolve().then(a.bind(a,5e3))},5e3:(e,s,a)=>{"use strict";a.d(s,{default:()=>o});var n=a(5155),i=a(5695),l=a(2115),t=a(2501);a(2662);let r=(0,l.memo)(e=>{let{show:s,reason:a,onReasonChange:i,onSubmit:l,onCancel:t,isSubmitting:r}=e;return s?(0,n.jsx)("div",{className:"rejection-modal-overlay",children:(0,n.jsxs)("div",{className:"rejection-modal",children:[(0,n.jsxs)("div",{className:"rejection-modal-header",children:[(0,n.jsx)("h3",{children:"❌ Rejection Reason Required"}),(0,n.jsx)("button",{className:"modal-close-btn",onClick:t,disabled:r,children:"\xd7"})]}),(0,n.jsxs)("div",{className:"rejection-modal-body",children:[(0,n.jsx)("p",{children:"Please provide a reason for rejecting this sourcing request:"}),(0,n.jsxs)("p",{className:"rejection-note",children:[(0,n.jsx)("strong",{children:"Note:"})," This reason will be visible to the sourcer in the Sourcing page and Sourcing Details."]}),(0,n.jsx)("textarea",{className:"rejection-reason-input",placeholder:"Enter detailed reason for rejection...",value:a,onChange:i,rows:4,maxLength:500,autoFocus:!0,disabled:r}),(0,n.jsxs)("div",{className:"character-count ".concat(a.length>450?"warning":""," ").concat(a.length>=500?"danger":""),children:[a.length,"/500 characters"]})]}),(0,n.jsxs)("div",{className:"rejection-modal-footer",children:[(0,n.jsx)("button",{className:"btn-cancel-rejection",onClick:t,disabled:r,children:"Cancel"}),(0,n.jsx)("button",{className:"btn-submit-rejection",onClick:l,disabled:!a.trim()||r,children:r?"Submitting...":"Submit Rejection"})]})]})}):null}),c=(0,l.memo)(e=>{let{show:s,remarks:a,onRemarksChange:i,onSubmit:l,onCancel:t,isSubmitting:r,entryData:c}=e;return s?(0,n.jsx)("div",{className:"rejection-modal-overlay",children:(0,n.jsxs)("div",{className:"rejection-modal",children:[(0,n.jsxs)("div",{className:"rejection-modal-header",children:[(0,n.jsx)("h3",{children:"✅ Approval Remarks"}),(0,n.jsx)("button",{className:"modal-close-btn",onClick:t,disabled:r,children:"\xd7"})]}),(0,n.jsxs)("div",{className:"rejection-modal-body",children:[(0,n.jsx)("p",{children:"Please provide remarks for approving this entry:"}),(0,n.jsxs)("div",{className:"entry-info",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Entry ID:"})," ",null==c?void 0:c.id]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Bid Title:"})," ",null==c?void 0:c.bidTitle]})]}),(0,n.jsx)("textarea",{className:"rejection-reason-input",placeholder:"Enter your approval remarks and comments here...",value:a,onChange:i,rows:4,maxLength:500,autoFocus:!0,disabled:r}),(0,n.jsxs)("div",{className:"character-count ".concat(a.length>450?"warning":""," ").concat(a.length>=500?"danger":""),children:[a.length,"/500 characters"]})]}),(0,n.jsxs)("div",{className:"rejection-modal-footer",children:[(0,n.jsx)("button",{className:"btn-cancel-rejection",onClick:t,disabled:r,children:"Cancel"}),(0,n.jsx)("button",{className:"btn-submit-approval",onClick:l,disabled:!a.trim()||r,style:{background:"linear-gradient(135deg, #28a745 0%, #1e7e34 100%)",color:"white"},children:r?"Approving...":"✅ Approve with Remarks"})]})]})}):null}),o=()=>{let e=(0,i.useRouter)(),[s,a]=(0,l.useState)([]),[o,d]=(0,l.useState)(!0),[m,u]=(0,l.useState)("all"),[h,p]=(0,l.useState)(""),[v,j]=(0,l.useState)(!1),[x,g]=(0,l.useState)(null),[N,f]=(0,l.useState)(0),[b,w]=(0,l.useState)(!1),[D,y]=(0,l.useState)(null),[A,k]=(0,l.useState)(!1),[C,S]=(0,l.useState)({show:!1,reason:"",entryId:null,isSubmitting:!1}),[I,R]=(0,l.useState)({show:!1,remarks:"",entryData:null,isSubmitting:!1}),E="2025-08-01 16:32:01",q="Mike469-a11y";(0,l.useEffect)(()=>{t.A.initDB().catch(e=>{console.error("Failed to initialize IndexedDB:",e)})},[]),(0,l.useEffect)(()=>{"/approval"===window.location.pathname&&v&&(j(!1),g(null),f(0),w(!1),k(!1))},[window.location.pathname,v]),(0,l.useEffect)(()=>{let e=()=>{var e,s;v&&(null==x||null==(s=x.sourcingData)||null==(e=s.vendors)?void 0:e.length)>1&&(k(!0),w(!1),D&&clearTimeout(D),y(setTimeout(()=>{k(!1),w(!0)},1500)))};return window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e),D&&clearTimeout(D)}},[v,x,D]),(0,l.useEffect)(()=>{let e=()=>{!window.location.pathname.includes("/approval/review/")&&"/approval"===window.location.pathname&&v&&$()};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)},[v]),(0,l.useEffect)(()=>{B(),reviewId&&V(reviewId)},[reviewId]),(0,l.useEffect)(()=>{let e=e=>{var s;if(v&&(null==x||null==(s=x.sourcingData)?void 0:s.vendors)){let s=x.sourcingData.vendors.length;"ArrowLeft"===e.key&&N>0?f(e=>e-1):"ArrowRight"===e.key&&N<s-1&&f(e=>e+1)}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[v,x,N]);let B=()=>{try{let e=localStorage.getItem("sourcingEntries");if(e){let s=JSON.parse(e).filter(e=>e.sourcingCompleted&&("approval_pending"===e.status||"approval_approved"===e.status||"approval_rejected"===e.status)&&!e.hiddenFromApproval);a(s)}}catch(e){console.error("Error loading approval entries:",e)}finally{d(!1)}},F=(0,l.useMemo)(()=>s.filter(e=>{var s,a,n,i,l;let t="all"===m||e.status===m,r=(null==(s=e.bidTitle)?void 0:s.toLowerCase().includes(h.toLowerCase()))||(null==(a=e.bidNumber)?void 0:a.toLowerCase().includes(h.toLowerCase()))||(null==(n=e.portalName)?void 0:n.toLowerCase().includes(h.toLowerCase()))||(null==(i=e.sourcerName)?void 0:i.toLowerCase().includes(h.toLowerCase()))||(null==(l=e.hunterName)?void 0:l.toLowerCase().includes(h.toLowerCase()));return t&&r}),[s,m,h]),T=e=>{let s={approval_pending:{label:"Pending Review",class:"status-pending",icon:"⏳"},approval_approved:{label:"Approved",class:"status-approved",icon:"✅"},approval_rejected:{label:"Rejected",class:"status-rejected",icon:"❌"}},a=s[e]||s.approval_pending;return(0,n.jsxs)("span",{className:"status-badge ".concat(a.class),children:[a.icon," ",a.label]})},P=()=>{f(e=>Math.max(0,e-1))},L=()=>{var e;if(null==x||null==(e=x.sourcingData)?void 0:e.vendors){let e=x.sourcingData.vendors.length-1;f(s=>Math.min(e,s+1))}},U=async(e,s)=>{try{console.log("\uD83D\uDCE5 Downloading attachment:",e);let a="",n=e.name||"".concat(s,"_attachment");if("string"==typeof e){console.log("\uD83D\uDCC4 Fetching file from IndexedDB with ID:",e);let s=await t.A.getAttachment(e);if(s&&s.file)a=URL.createObjectURL(s.file),n=s.name||n,console.log("✅ Retrieved file from IndexedDB");else throw Error("File not found in IndexedDB")}else if(e.file&&e.file instanceof File)a=URL.createObjectURL(e.file),n=e.file.name||n,console.log("\uD83D\uDCC4 Using File object for download");else if(e.file)a=URL.createObjectURL(e.file),n=e.name||n,console.log("\uD83D\uDCC4 Using attachment file property");else if(e.data){let s,n=e.type||"application/octet-stream";if("string"==typeof e.data)try{let a=e.data.includes(",")?e.data.split(",")[1]:e.data;s=Uint8Array.from(atob(a),e=>e.charCodeAt(0)),console.log("\uD83D\uDCC4 Converting base64 to blob")}catch(a){s=e.data,n="text/plain",console.log("\uD83D\uDCC4 Using text data")}else s=e.data,console.log("\uD83D\uDCC4 Using binary data");let i=new Blob([s],{type:n});a=URL.createObjectURL(i)}else if(e.url)a=e.url,console.log("\uD83D\uDCC4 Using URL for download");else throw Error("No valid file data found");let i=document.createElement("a");i.href=a,i.download=n,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),a.startsWith("blob:")&&setTimeout(()=>URL.revokeObjectURL(a),1e3),console.log("✅ Downloaded: ".concat(n," from ").concat(s)),alert("\uD83D\uDCE5 Downloaded: ".concat(n))}catch(s){console.error("❌ Error downloading file:",s),alert("❌ Error downloading file: ".concat(e.name||"Unknown","\n\nError: ").concat(s.message,"\n\nPlease ensure the file was uploaded correctly in SourcingDetails."))}},_=async(e,s)=>{try{console.log("\uD83D\uDC41️ Previewing attachment:",e);let a="",n=e.name||"".concat(s,"_attachment");if("string"==typeof e){console.log("\uD83D\uDCC4 Fetching file from IndexedDB with ID:",e);let s=await t.A.getAttachment(e);if(s&&s.file)a=URL.createObjectURL(s.file),n=s.name||n,console.log("✅ Retrieved file from IndexedDB for preview");else throw Error("File not found in IndexedDB")}else if(e.file&&e.file instanceof File)a=URL.createObjectURL(e.file),n=e.file.name||n,console.log("\uD83D\uDCC4 Using File object for preview");else if(e.file)a=URL.createObjectURL(e.file),n=e.name||n,console.log("\uD83D\uDCC4 Using attachment file property");else if(e.data){let s,n=e.type||"application/pdf";if("string"==typeof e.data)try{let a=e.data.includes(",")?e.data.split(",")[1]:e.data;s=Uint8Array.from(atob(a),e=>e.charCodeAt(0)),console.log("\uD83D\uDCC4 Converting base64 to blob for preview")}catch(a){s=e.data,n="text/plain",console.log("\uD83D\uDCC4 Using text data for preview")}else s=e.data,console.log("\uD83D\uDCC4 Using binary data for preview");let i=new Blob([s],{type:n});a=URL.createObjectURL(i)}else if(e.url)a=e.url,console.log("\uD83D\uDCC4 Using URL for preview");else throw Error("No valid file data found");let i=window.open(a,"_blank","width=1000,height=800,scrollbars=yes,resizable=yes");i?(console.log("✅ Previewing: ".concat(n," from ").concat(s)),i.document.title="Preview: ".concat(n)):alert("❌ Preview blocked by browser popup blocker.\n\nPlease:\n1. Allow popups for this site\n2. Try again\n\nAlternatively, download the file to view it."),a.startsWith("blob:")&&setTimeout(()=>URL.revokeObjectURL(a),6e4)}catch(s){console.error("❌ Error previewing file:",s),alert("❌ Error previewing file: ".concat(e.name||"Unknown","\n\nError: ").concat(s.message,"\n\nTry downloading the file instead, or check if it was uploaded correctly in SourcingDetails."))}},O=async(e,s)=>{var a,n;if(!(null==(a=e.sourcingInfo)?void 0:a.attachments)||0===e.sourcingInfo.attachments.length)return void alert("\uD83D\uDCED No attachments found for this vendor.");let i=(null==(n=e.sourcingInfo)?void 0:n.vendorName)||"Vendor_".concat(s+1);try{for(let s=0;s<e.sourcingInfo.attachments.length;s++){let a=e.sourcingInfo.attachments[s];setTimeout(async()=>{await U(a,i)},1e3*s)}alert("\uD83D\uDCE5 Downloading ".concat(e.sourcingInfo.attachments.length," files from ").concat(i,"...\n\nFiles will download with 1 second intervals to prevent browser blocking."))}catch(e){console.error("❌ Error downloading all files:",e),alert("❌ Error downloading files from ".concat(i,": ").concat(e.message))}},V=async e=>{try{d(!0);let s=localStorage.getItem("sourcingEntries");if(s){let a=JSON.parse(s).find(s=>s.id===e);a&&(g(a),j(!0),f(0),w(!1),k(!1),window.history.pushState({},"","/approval/review/".concat(e)))}}catch(e){console.error("Error loading review data:",e),alert("❌ Error loading review data. Please try again.")}finally{d(!1)}},$=()=>{j(!1),g(null),f(0),w(!1),k(!1),e.push("/approval")},Q=(0,l.useCallback)(async e=>{if(window.confirm("Are you sure you want to delete entry ".concat(e," from Approval Dashboard?\n\nNote: This will NOT affect the Sourcing section.")))try{let s=localStorage.getItem("sourcingEntries");if(s){let a=JSON.parse(s).map(s=>s.id===e?{...s,hiddenFromApproval:!0,hiddenFromApprovalAt:E,hiddenFromApprovalBy:q}:s);localStorage.setItem("sourcingEntries",JSON.stringify(a)),B(),alert("✅ Entry ".concat(e," removed from Approval Dashboard.\n\n\uD83D\uDCCB Entry remains available in Sourcing section."))}}catch(e){console.error("Error hiding entry from approval:",e),alert("❌ Error removing entry. Please try again.")}},[E,q]),J=(0,l.useCallback)(async e=>{R({show:!0,remarks:"",entryData:e,isSubmitting:!1})},[]),W=(0,l.useCallback)(async()=>{if(!I.remarks.trim())return void alert("❌ Please provide approval remarks.");R(e=>({...e,isSubmitting:!0}));try{let e=I.entryData.id,s=localStorage.getItem("sourcingEntries");if(s){let a=JSON.parse(s);if(a.find(s=>s.id===e)){let s=a.map(s=>s.id===e?{...s,status:"approval_approved",approvalAction:"approve",approvedBy:q,approvedAt:E,approvalRemarks:I.remarks.trim(),approvalComments:"Approved by ".concat(q,": ").concat(I.remarks.trim()),lastActionBy:q,lastActionAt:E,lastAction:"approved_from_approval"}:s);localStorage.setItem("sourcingEntries",JSON.stringify(s));let n=localStorage.getItem("submissionEntries"),i=n?JSON.parse(n):[];if(i.find(s=>s.id===e)){let a=i.map(a=>a.id===e?{...a,...s.find(s=>s.id===e),submissionStatus:"pending_submission"}:a);localStorage.setItem("submissionEntries",JSON.stringify(a))}else{let a={...s.find(s=>s.id===e),submittedToSubmission:!0,submittedAt:E,submittedBy:q,submissionStatus:"pending_submission",originalApprovalStatus:"approval_approved",submissionId:"SUB-".concat(e),lastSubmissionAction:"submitted_from_approval"};i.push(a),localStorage.setItem("submissionEntries",JSON.stringify(i))}if(B(),v&&x&&x.id===e){let a=s.find(s=>s.id===e);g(a)}alert("✅ Entry ".concat(e," approved with remarks and submitted to Submission Dashboard!\n\n\uD83D\uDCCB You can now find it in the Submission section for final processing."))}}}catch(e){console.error("Error submitting to submission:",e),alert("❌ Error submitting entry. Please try again.")}finally{R({show:!1,remarks:"",entryData:null,isSubmitting:!1})}},[I.remarks,I.entryData,E,q,v,x,B]),M=(0,l.useCallback)(()=>{R({show:!1,remarks:"",entryData:null,isSubmitting:!1})},[]),z=(0,l.useCallback)(e=>{let s=e.target.value;R(e=>({...e,remarks:s}))},[]),G=(0,l.useCallback)(function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],S({show:!0,reason:"",entryId:e,isSubmitting:!1})},[]),Y=(0,l.useCallback)(e=>{let s=e.target.value;S(e=>({...e,reason:s}))},[]),K=(0,l.useCallback)(async()=>{if(!C.reason.trim())return void alert("❌ Please provide a reason for rejection.");S(e=>({...e,isSubmitting:!0}));try{let e=localStorage.getItem("sourcingEntries");if(e){let s=JSON.parse(e).map(e=>e.id===C.entryId?{...e,status:"approval_rejected",approvalAction:"reject",approvedBy:q,approvedAt:E,rejectionReason:C.reason.trim(),approvalComments:"Rejected by ".concat(q,": ").concat(C.reason.trim()),rejectedBy:q,rejectedAt:E,rejectionDetails:{reason:C.reason.trim(),rejectedBy:q,rejectedAt:E,fromSection:"approval",needsRevision:!0},sourcingStatus:"needs_revision",needsRevision:!0,revisionRequired:!0,lastActionBy:q,lastActionAt:E,lastAction:"rejected_from_approval",rejectionAcknowledged:!1,rejectionAcknowledgedBy:null,rejectionAcknowledgedAt:null,rejectionViewed:!1}:e);if(localStorage.setItem("sourcingEntries",JSON.stringify(s)),B(),v&&x&&x.id===C.entryId){let e=s.find(e=>e.id===C.entryId);g(e)}S({show:!1,reason:"",entryId:null,isSubmitting:!1}),alert("✅ Entry rejected successfully!\n\n"+"Reason: ".concat(C.reason.trim(),"\n\n")+"✨ The rejection has been sent to the Sourcing section for revision.\n✨ The sourcer will see this rejection message in Sourcing Details.")}}catch(e){console.error("Error rejecting entry:",e),alert("❌ Error rejecting entry. Please try again.")}finally{S(e=>({...e,isSubmitting:!1}))}},[C.reason,C.entryId,q,E,v,x,B]),H=(0,l.useCallback)(()=>{S({show:!1,reason:"",entryId:null,isSubmitting:!1})},[]),X=async e=>{let a=s.find(s=>s.id===e);a&&J(a)};if(o)return(0,n.jsx)("div",{className:"approval-container",children:(0,n.jsxs)("div",{className:"loading-container",children:[(0,n.jsx)("div",{className:"loading-spinner"}),(0,n.jsx)("p",{children:"Loading approval entries..."})]})});if(v&&x){var Z,ee,es,ea,en,ei,el,et,er,ec,eo,ed,em,eu,eh,ep,ev,ej,ex,eg,eN,ef,eb,ew,eD,ey,eA,ek,eC,eS,eI,eR,eE,eq,eB,eF,eT,eP,eL,eU,e_,eO,eV,e$,eQ,eJ,eW,eM,ez;let e=(null==(Z=x.sourcingData)?void 0:Z.vendors)||[],s=e[N],a=e.length;return(0,n.jsxs)("div",{className:"approval-container",children:[(0,n.jsx)(r,{show:C.show,reason:C.reason,onReasonChange:Y,onSubmit:K,onCancel:H,isSubmitting:C.isSubmitting}),(0,n.jsx)(c,{show:I.show,remarks:I.remarks,onRemarksChange:z,onSubmit:W,onCancel:M,isSubmitting:I.isSubmitting,entryData:I.entryData}),b&&a>1&&!A&&(0,n.jsxs)("div",{className:"floating-vendor-nav",children:[(0,n.jsx)("button",{className:"floating-nav-btn floating-prev",onClick:P,disabled:0===N,title:"Previous Vendor",children:"← Prev"}),(0,n.jsxs)("div",{className:"floating-nav-info",children:[N+1," of ",a]}),(0,n.jsx)("button",{className:"floating-nav-btn floating-next",onClick:L,disabled:N===a-1,title:"Next Vendor",children:"Next →"})]}),(0,n.jsxs)("div",{className:"review-page-header",children:[(0,n.jsxs)("div",{className:"header-left",children:[(0,n.jsxs)("h1",{children:["\uD83D\uDCCB Sourcing Review - ",x.id]}),(0,n.jsx)("p",{children:"Complete sourcing details and vendor comparison"})]}),(0,n.jsx)("div",{className:"header-right",children:(0,n.jsxs)("div",{className:"user-info",children:[(0,n.jsxs)("span",{children:["Current User: ",(0,n.jsx)("strong",{children:q})]}),(0,n.jsx)("span",{className:"current-time",children:E})]})})]}),(0,n.jsxs)("div",{className:"review-page-content",children:[(0,n.jsxs)("div",{className:"review-section qms-section-compact",children:[(0,n.jsxs)("div",{className:"section-header",children:[(0,n.jsx)("div",{className:"section-icon",children:"\uD83D\uDCCB"}),(0,n.jsx)("h3",{children:"Original QMS Information"})]}),(0,n.jsxs)("div",{className:"qms-compact-grid",children:[(0,n.jsxs)("div",{className:"qms-compact-item",children:[(0,n.jsx)("span",{className:"qms-label",children:"Entry ID:"}),(0,n.jsx)("span",{className:"qms-value",children:x.id})]}),(0,n.jsxs)("div",{className:"qms-compact-item",children:[(0,n.jsx)("span",{className:"qms-label",children:"Sourcer:"}),(0,n.jsx)("span",{className:"qms-value",children:x.sourcerName||x.hunterName||"Not Assigned"})]}),(0,n.jsxs)("div",{className:"qms-compact-item",children:[(0,n.jsx)("span",{className:"qms-label",children:"Bid Title:"}),(0,n.jsx)("span",{className:"qms-value",children:x.bidTitle||"N/A"})]}),(0,n.jsxs)("div",{className:"qms-compact-item",children:[(0,n.jsx)("span",{className:"qms-label",children:"Portal:"}),(0,n.jsx)("span",{className:"qms-value",children:x.portalName||"N/A"})]}),(0,n.jsxs)("div",{className:"qms-compact-item",children:[(0,n.jsx)("span",{className:"qms-label",children:"Bid Number:"}),(0,n.jsx)("span",{className:"qms-value",children:x.bidNumber||"N/A"})]}),(0,n.jsxs)("div",{className:"qms-compact-item",children:[(0,n.jsx)("span",{className:"qms-label",children:"Category:"}),(0,n.jsx)("span",{className:"qms-value",children:x.category||"N/A"})]}),(0,n.jsxs)("div",{className:"qms-compact-item",children:[(0,n.jsx)("span",{className:"qms-label",children:"Quantity:"}),(0,n.jsx)("span",{className:"qms-value",children:x.quantity||"N/A"})]}),(0,n.jsxs)("div",{className:"qms-compact-item",children:[(0,n.jsx)("span",{className:"qms-label",children:"Due Date:"}),(0,n.jsx)("span",{className:"qms-value",children:x.dueDate||"N/A"})]}),(0,n.jsxs)("div",{className:"qms-compact-item",children:[(0,n.jsx)("span",{className:"qms-label",children:"Created:"}),(0,n.jsx)("span",{className:"qms-value",children:x.dateCreated||"N/A"})]}),(0,n.jsxs)("div",{className:"qms-compact-item",children:[(0,n.jsx)("span",{className:"qms-label",children:"Assigned By:"}),(0,n.jsx)("span",{className:"qms-value",children:x.assignedBy||"N/A"})]}),(0,n.jsxs)("div",{className:"qms-compact-item",children:[(0,n.jsx)("span",{className:"qms-label",children:"Contact:"}),(0,n.jsx)("span",{className:"qms-value",children:x.contactName||"N/A"})]}),(0,n.jsxs)("div",{className:"qms-compact-item",children:[(0,n.jsx)("span",{className:"qms-label",children:"Email:"}),(0,n.jsx)("span",{className:"qms-value",children:x.email||"N/A"})]}),(x.sourcingRemarks||x.huntingRemarks)&&(0,n.jsxs)("div",{className:"qms-compact-item qms-full-width",children:[(0,n.jsx)("span",{className:"qms-label",children:"Remarks:"}),(0,n.jsx)("span",{className:"qms-value",children:x.sourcingRemarks||x.huntingRemarks})]})]})]}),e.length>0&&(0,n.jsxs)("div",{className:"review-section vendor-carousel-section",children:[(0,n.jsxs)("div",{className:"section-header",children:[(0,n.jsx)("div",{className:"section-icon",children:"\uD83C\uDFE2"}),(0,n.jsxs)("h3",{children:["Vendor Details (",a," Vendor",a>1?"s":"",")"]})]}),(0,n.jsxs)("div",{className:"vendor-carousel-container",children:[(0,n.jsxs)("div",{className:"carousel-header",children:[(0,n.jsx)("button",{className:"carousel-nav-btn carousel-prev",onClick:P,disabled:0===N,title:"Previous Vendor (← Arrow Key)",children:"← Previous"}),(0,n.jsxs)("div",{className:"carousel-title",children:[(0,n.jsxs)("h4",{children:["Vendor ",N+1," of ",a,(null==s?void 0:s.isPrimary)&&(0,n.jsx)("span",{className:"primary-badge",children:"⭐ PRIMARY"})]}),(0,n.jsx)("div",{className:"vendor-name-display",children:(null==s||null==(ee=s.sourcingInfo)?void 0:ee.vendorName)||(null==s?void 0:s.vendorName)||"Unknown Vendor"})]}),(0,n.jsx)("button",{className:"carousel-nav-btn carousel-next",onClick:L,disabled:N===a-1,title:"Next Vendor (→ Arrow Key)",children:"Next →"})]}),(0,n.jsx)("div",{className:"carousel-indicators",children:e.map((e,s)=>(0,n.jsx)("button",{className:"carousel-indicator ".concat(s===N?"active":""),onClick:()=>{f(s)},title:"Go to Vendor ".concat(s+1),children:s===N?"●":"○"},s))}),s&&(0,n.jsxs)("div",{className:"carousel-vendor-content",children:[(0,n.jsxs)("div",{className:"sourcing-info-card",children:[(0,n.jsx)("h5",{children:"\uD83D\uDCCB Sourcing Information"}),(0,n.jsxs)("div",{className:"sourcing-fields-list",children:[(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Vendor Name:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(es=s.sourcingInfo)?void 0:es.vendorName)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Quoted Cost:"}),(0,n.jsxs)("span",{className:"field-value-compact cost-value",children:["$",(null==(ea=s.sourcingInfo)?void 0:ea.productServiceQuotedCost)||"0.00"]})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Website:"}),(0,n.jsx)("span",{className:"field-value-compact website-link",children:(null==(en=s.sourcingInfo)?void 0:en.vendorWebsite)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact full-width-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Vendor Address:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(ei=s.sourcingInfo)?void 0:ei.vendorAddress)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Proper Quotation:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(el=s.sourcingInfo)?void 0:el.properQuotationGiven)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Proper Quotation (Vendor):"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(et=s.sourcingInfo)?void 0:et.properQuotationGivenNew)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Risk Assessment:"}),(0,n.jsx)("span",{className:"field-value-compact risk-indicator risk-".concat(null==(eo=s.sourcingInfo)||null==(ec=eo.riskAssessment)||null==(er=ec.toLowerCase())?void 0:er.replace(" ","-")),children:(null==(ed=s.sourcingInfo)?void 0:ed.riskAssessment)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Compliance:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(em=s.sourcingInfo)?void 0:em.compliance)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"CC Accepted:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(eu=s.sourcingInfo)?void 0:eu.ccAccepted)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"NET Terms:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(eh=s.sourcingInfo)?void 0:eh.netTermsAvailable)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"CC Charges:"}),(0,n.jsxs)("span",{className:"field-value-compact",children:[(null==(ep=s.sourcingInfo)?void 0:ep.ccCharges)||"N/A","%"]})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Specs Sheet Taken:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(ev=s.sourcingInfo)?void 0:ev.specsSheetTaken)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Lead Time:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(ej=s.sourcingInfo)?void 0:ej.leadTimeOffered)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Stock Available:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(ex=s.sourcingInfo)?void 0:ex.stockAvailable)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Quote Receiving Date:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(eg=s.sourcingInfo)?void 0:eg.quoteReceivingDate)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Quote Valid Till:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(eN=s.sourcingInfo)?void 0:eN.quoteValidTill)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Remaining Days:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(ef=s.sourcingInfo)?void 0:ef.remainingDays)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Item Same/Alternative:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(eb=s.sourcingInfo)?void 0:eb.itemSameAlternative)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Warranty:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(ew=s.sourcingInfo)?void 0:ew.warrantyPeriod)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"After Sales Support:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(eD=s.sourcingInfo)?void 0:eD.afterSalesSupport)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Support Period:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(ey=s.sourcingInfo)?void 0:ey.supportPeriod)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact full-width-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Warranty/Support Terms:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(eA=s.sourcingInfo)?void 0:eA.warrantySupportTerms)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Shipping Cost:"}),(0,n.jsxs)("span",{className:"field-value-compact cost-value",children:["$",(null==(ek=s.sourcingInfo)?void 0:ek.estimatedShippingCost)||"0.00"]})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Applicable Taxes:"}),(0,n.jsx)("span",{className:"field-value-compact",children:(null==(eC=s.sourcingInfo)?void 0:eC.applicableTaxes)||"N/A"})]}),(0,n.jsxs)("div",{className:"sourcing-field-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"Restocking Fees:"}),(0,n.jsxs)("span",{className:"field-value-compact",children:[(null==(eS=s.sourcingInfo)?void 0:eS.restockingFees)||"N/A",(null==(eI=s.sourcingInfo)?void 0:eI.restockingFees)==="Yes"&&(null==(eR=s.sourcingInfo)?void 0:eR.restockingFeesPercentage)&&" (".concat(s.sourcingInfo.restockingFeesPercentage,"%)")]})]})]})]}),(0,n.jsxs)("div",{className:"pricing-card",children:[(0,n.jsx)("h5",{children:"\uD83D\uDCB0 Pricing & Line Items"}),(null==(eE=s.pricing)?void 0:eE.lineItems)&&s.pricing.lineItems.length>0&&(0,n.jsxs)("div",{className:"line-items-compact",children:[(0,n.jsx)("h6",{children:"Line Items"}),(0,n.jsx)("div",{className:"line-items-list",children:s.pricing.lineItems.map((e,s)=>(0,n.jsxs)("div",{className:"line-item-row",children:[(0,n.jsx)("div",{className:"line-item-desc",children:e.description||"N/A"}),(0,n.jsxs)("div",{className:"line-item-details",children:["Qty: ",e.qty||"0"," | Unit: $",e.unitPrice||"0.00"," | Total: $",(e.cost||0).toFixed(2)]})]},e.id||s))})]}),(0,n.jsxs)("div",{className:"cost-breakdown-compact",children:[(0,n.jsx)("h6",{children:"Cost Breakdown"}),(0,n.jsxs)("div",{className:"breakdown-list",children:[(0,n.jsxs)("div",{className:"breakdown-item-compact",children:[(0,n.jsx)("span",{children:"Total:"}),(0,n.jsxs)("span",{children:["$",((null==(eq=s.pricing)?void 0:eq.subtotal)||0).toFixed(2)]})]}),(0,n.jsxs)("div",{className:"breakdown-item-compact",children:[(0,n.jsx)("span",{children:"CC Charges:"}),(0,n.jsxs)("span",{children:["$",((null==(eB=s.pricing)?void 0:eB.ccChargesAmount)||0).toFixed(2)]})]}),(0,n.jsxs)("div",{className:"breakdown-item-compact",children:[(0,n.jsx)("span",{children:"Tax:"}),(0,n.jsxs)("span",{children:["$",((null==(eF=s.pricing)?void 0:eF.taxAmount)||0).toFixed(2)]})]}),(0,n.jsxs)("div",{className:"breakdown-item-compact",children:[(0,n.jsx)("span",{children:"Freight:"}),(0,n.jsxs)("span",{children:["$",((null==(eT=s.pricing)?void 0:eT.freightLogistics)||0).toFixed(2)]})]}),(0,n.jsxs)("div",{className:"breakdown-item-compact",children:[(0,n.jsx)("span",{children:"Extended Warranty:"}),(0,n.jsxs)("span",{children:["$",((null==(eP=s.pricing)?void 0:eP.extendedWarranty)||0).toFixed(2)]})]}),(0,n.jsxs)("div",{className:"breakdown-item-compact",children:[(0,n.jsx)("span",{children:"Installation:"}),(0,n.jsxs)("span",{children:["$",((null==(eL=s.pricing)?void 0:eL.installation)||0).toFixed(2)]})]}),(0,n.jsxs)("div",{className:"breakdown-item-compact",children:[(0,n.jsx)("span",{children:"Restocking Fees:"}),(0,n.jsxs)("span",{children:["$",((null==(eU=s.pricing)?void 0:eU.restockingFeesAmount)||0).toFixed(2)]})]}),(0,n.jsxs)("div",{className:"breakdown-item-compact",children:[(0,n.jsx)("span",{children:"Other 1:"}),(0,n.jsxs)("span",{children:["$",((null==(e_=s.pricing)?void 0:e_.other1)||0).toFixed(2)]})]}),(0,n.jsxs)("div",{className:"breakdown-item-compact",children:[(0,n.jsx)("span",{children:"Other 2:"}),(0,n.jsxs)("span",{children:["$",((null==(eO=s.pricing)?void 0:eO.other2)||0).toFixed(2)]})]}),(0,n.jsxs)("div",{className:"breakdown-item-compact grand-total-compact",children:[(0,n.jsx)("span",{children:"Grand Total:"}),(0,n.jsxs)("span",{children:["$",((null==(eV=s.pricing)?void 0:eV.grandTotal)||0).toFixed(2)]})]}),(0,n.jsxs)("div",{className:"breakdown-item-compact",children:[(0,n.jsx)("span",{children:"Discount 1:"}),(0,n.jsxs)("span",{children:["-$",((null==(e$=s.pricing)?void 0:e$.discount1)||0).toFixed(2)]})]}),(0,n.jsxs)("div",{className:"breakdown-item-compact",children:[(0,n.jsx)("span",{children:"Discount 2:"}),(0,n.jsxs)("span",{children:["-$",((null==(eQ=s.pricing)?void 0:eQ.discount2)||0).toFixed(2)]})]}),(0,n.jsxs)("div",{className:"breakdown-item-compact final-total-compact",children:[(0,n.jsx)("span",{children:"Final Total:"}),(0,n.jsxs)("span",{children:["$",((null==(eJ=s.pricing)?void 0:eJ.finalGrandTotal)||0).toFixed(2)]})]})]})]})]}),(null==(eW=s.sourcingInfo)?void 0:eW.remarks)&&(0,n.jsxs)("div",{className:"sourcing-info-card",style:{marginTop:"20px"},children:[(0,n.jsx)("h5",{children:"\uD83D\uDCDD Vendor Remarks/Notes"}),(0,n.jsx)("div",{className:"sourcing-fields-list",children:(0,n.jsxs)("div",{className:"sourcing-field-compact full-width-compact",children:[(0,n.jsx)("span",{className:"field-label-compact",children:"\uD83C\uDD95 Remarks / Notes:"}),(0,n.jsx)("span",{className:"field-value-compact",children:s.sourcingInfo.remarks})]})})]})]})]})]}),e.length>0&&(null==s||null==(eM=s.sourcingInfo)?void 0:eM.attachments)&&s.sourcingInfo.attachments.length>0&&(0,n.jsxs)("div",{className:"review-section",children:[(0,n.jsxs)("div",{className:"section-header",children:[(0,n.jsx)("div",{className:"section-icon",children:"\uD83D\uDCCE"}),(0,n.jsxs)("h3",{children:["Vendor Attachments - ",(null==(ez=s.sourcingInfo)?void 0:ez.vendorName)||"Vendor ".concat(N+1)]})]}),(0,n.jsxs)("div",{className:"attachments-card",children:[(0,n.jsxs)("div",{className:"attachments-header",children:[(0,n.jsxs)("h6",{children:["\uD83D\uDCCE Attachments (",s.sourcingInfo.attachments.length,")"]}),(0,n.jsx)("button",{className:"btn-download-all",onClick:()=>O(s,N),title:"Download all files",children:"\uD83D\uDCE5 Download All"})]}),(0,n.jsx)("div",{className:"attachments-list-compact",children:s.sourcingInfo.attachments.map((e,a)=>{var i,l,t,r,c,o,d,m;return(0,n.jsxs)("div",{className:"attachment-item-compact",children:[(0,n.jsxs)("div",{className:"attachment-info-compact",children:[(0,n.jsxs)("div",{className:"attachment-name-compact",children:[e.name||(null==(i=e.file)?void 0:i.name)||"File ".concat(a+1),(e.type||(null==(l=e.file)?void 0:l.type))&&(0,n.jsxs)("span",{className:"file-type-indicator",children:["(",null==(t=(e.type||(null==(r=e.file)?void 0:r.type)).split("/")[1])?void 0:t.toUpperCase(),")"]})]}),(0,n.jsxs)("div",{className:"attachment-details-compact",children:[(0,n.jsx)("span",{className:"attachment-size-compact",children:e.size||(null==(c=e.file)?void 0:c.size)||"Unknown size"}),(0,n.jsx)("span",{className:"attachment-type-compact",children:e.type||(null==(o=e.file)?void 0:o.type)||"Unknown type"})]})]}),(0,n.jsxs)("div",{className:"attachment-actions-compact",children:[(0,n.jsx)("button",{className:"btn-preview-file",onClick:()=>{var a;return _(e,(null==(a=s.sourcingInfo)?void 0:a.vendorName)||"Vendor ".concat(N+1))},title:"Preview ".concat(e.name||(null==(d=e.file)?void 0:d.name)||"file"),children:"\uD83D\uDC41️"}),(0,n.jsx)("button",{className:"btn-download-file",onClick:()=>{var a;return U(e,(null==(a=s.sourcingInfo)?void 0:a.vendorName)||"Vendor ".concat(N+1))},title:"Download ".concat(e.name||(null==(m=e.file)?void 0:m.name)||"file"),children:"\uD83D\uDCE5"})]})]},a)})})]})]}),"approval_pending"===x.status&&(0,n.jsxs)("div",{className:"review-approval-actions",children:[(0,n.jsxs)("div",{className:"section-header",children:[(0,n.jsx)("div",{className:"section-icon",children:"⚖️"}),(0,n.jsx)("h3",{children:"Approval Decision"})]}),(0,n.jsxs)("div",{className:"approval-buttons",children:[(0,n.jsx)("button",{className:"btn-approve-review",onClick:()=>X(x.id),children:"✅ Approve Request"}),(0,n.jsx)("button",{className:"btn-reject-review",onClick:()=>G(x.id,"review"),children:"❌ Reject Request"})]})]}),("approval_approved"===x.status||"approval_rejected"===x.status)&&(0,n.jsxs)("div",{className:"review-status-display",children:[(0,n.jsxs)("div",{className:"section-header",children:[(0,n.jsx)("div",{className:"section-icon",children:"\uD83D\uDCCB"}),(0,n.jsx)("h3",{children:"Approval Status"})]}),(0,n.jsxs)("div",{className:"status-display ".concat(x.status),children:[T(x.status),(0,n.jsxs)("div",{className:"status-details",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Action:"})," ","approval_approved"===x.status?"Approved":"Rejected"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"By:"})," ",x.approvedBy||x.rejectedBy||"N/A"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Date:"})," ",x.approvedAt||x.rejectedAt||"N/A"]}),"approval_approved"===x.status&&x.approvalRemarks&&(0,n.jsxs)("div",{className:"approval-remarks-display",children:[(0,n.jsx)("p",{children:(0,n.jsx)("strong",{children:"Approval Remarks:"})}),(0,n.jsx)("div",{className:"approval-remarks-text",children:x.approvalRemarks})]}),x.rejectionReason&&(0,n.jsxs)("div",{className:"rejection-reason-display",children:[(0,n.jsx)("p",{children:(0,n.jsx)("strong",{children:"Rejection Reason:"})}),(0,n.jsx)("div",{className:"rejection-reason-text",children:x.rejectionReason}),(0,n.jsx)("div",{className:"rejection-flow-info",children:(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"\uD83D\uDCE8 Sent to Sourcing:"})," This rejection message has been sent to the Sourcing section for revision."]})}),x.rejectionAcknowledged&&(0,n.jsx)("div",{className:"acknowledgment-status-display",children:(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"✅ Acknowledged by:"})," ",x.rejectionAcknowledgedBy," at ",x.rejectionAcknowledgedAt]})})]}),x.approvalComments&&!x.rejectionReason&&(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Comments:"})," ",x.approvalComments]})]})]})]})]}),(0,n.jsx)("div",{className:"review-page-navigation",children:(0,n.jsx)("button",{className:"btn-back-to-approval",onClick:$,children:"← Back to Approval Dashboard"})})]})}return(0,n.jsxs)("div",{className:"approval-container",children:[(0,n.jsx)(r,{show:C.show,reason:C.reason,onReasonChange:Y,onSubmit:K,onCancel:H,isSubmitting:C.isSubmitting}),(0,n.jsx)(c,{show:I.show,remarks:I.remarks,onRemarksChange:z,onSubmit:W,onCancel:M,isSubmitting:I.isSubmitting,entryData:I.entryData}),(0,n.jsxs)("div",{className:"approval-header",children:[(0,n.jsxs)("div",{className:"header-left",children:[(0,n.jsx)("h1",{children:"\uD83D\uDCCB Approval Dashboard"}),(0,n.jsx)("p",{children:"Review and approve completed sourcing requests"})]}),(0,n.jsx)("div",{className:"header-right",children:(0,n.jsxs)("div",{className:"user-info",children:[(0,n.jsxs)("span",{children:["Current User: ",(0,n.jsx)("strong",{children:q})]}),(0,n.jsx)("span",{className:"current-time",children:E})]})})]}),(0,n.jsxs)("div",{className:"approval-filters",children:[(0,n.jsxs)("div",{className:"filter-group",children:[(0,n.jsx)("label",{children:"Filter by Status:"}),(0,n.jsxs)("select",{value:m,onChange:e=>u(e.target.value),className:"filter-select",children:[(0,n.jsx)("option",{value:"all",children:"All Statuses"}),(0,n.jsx)("option",{value:"approval_pending",children:"Pending Review"}),(0,n.jsx)("option",{value:"approval_approved",children:"Approved"}),(0,n.jsx)("option",{value:"approval_rejected",children:"Rejected"})]})]}),(0,n.jsxs)("div",{className:"search-group",children:[(0,n.jsx)("label",{children:"Search:"}),(0,n.jsx)("input",{type:"text",placeholder:"Search by bid title, number, portal, or sourcer...",value:h,onChange:e=>p(e.target.value),className:"search-input"})]}),(0,n.jsx)("button",{className:"btn-refresh",onClick:B,children:"\uD83D\uDD04 Refresh"})]}),(0,n.jsxs)("div",{className:"approval-stats",children:[(0,n.jsxs)("div",{className:"stat-card",children:[(0,n.jsx)("div",{className:"stat-icon",children:"\uD83D\uDCCA"}),(0,n.jsxs)("div",{className:"stat-content",children:[(0,n.jsx)("h3",{children:F.length}),(0,n.jsx)("p",{children:"Total Entries"})]})]}),(0,n.jsxs)("div",{className:"stat-card",children:[(0,n.jsx)("div",{className:"stat-icon",children:"⏳"}),(0,n.jsxs)("div",{className:"stat-content",children:[(0,n.jsx)("h3",{children:F.filter(e=>"approval_pending"===e.status).length}),(0,n.jsx)("p",{children:"Pending"})]})]}),(0,n.jsxs)("div",{className:"stat-card",children:[(0,n.jsx)("div",{className:"stat-icon",children:"✅"}),(0,n.jsxs)("div",{className:"stat-content",children:[(0,n.jsx)("h3",{children:F.filter(e=>"approval_approved"===e.status).length}),(0,n.jsx)("p",{children:"Approved"})]})]}),(0,n.jsxs)("div",{className:"stat-card",children:[(0,n.jsx)("div",{className:"stat-icon",children:"❌"}),(0,n.jsxs)("div",{className:"stat-content",children:[(0,n.jsx)("h3",{children:F.filter(e=>"approval_rejected"===e.status).length}),(0,n.jsx)("p",{children:"Rejected"})]})]})]}),(0,n.jsx)("div",{className:"approval-table-container",children:0===F.length?(0,n.jsxs)("div",{className:"no-entries",children:[(0,n.jsx)("div",{className:"no-entries-icon",children:"\uD83D\uDCED"}),(0,n.jsx)("h3",{children:"No Approval Entries Found"}),(0,n.jsx)("p",{children:0===s.length?"There are no sourcing requests ready for approval.":"No entries match your current filter criteria."}),0===s.length&&(0,n.jsx)("p",{className:"help-text",children:'Entries will appear here once sourcing is completed and marked as "Ready for Approval".'})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"table-header",children:[(0,n.jsx)("div",{className:"header-cell",children:"QMS Info"}),(0,n.jsx)("div",{className:"header-cell",children:"Vendor Info"}),(0,n.jsx)("div",{className:"header-cell",children:"Status"}),(0,n.jsx)("div",{className:"header-cell",children:"Total Value"}),(0,n.jsx)("div",{className:"header-cell",children:"Actions"})]}),F.map(s=>{var a,i,l,t,r,c,o,d,m;let u=(e=>{var s;return(null==(s=e.sourcingData)?void 0:s.vendors)?e.sourcingData.vendors.find(e=>e.isPrimary)||e.sourcingData.vendors[0]:null})(s),h=u?(e=>(null==e?void 0:e.pricing)&&(e.pricing.finalGrandTotal||e.pricing.grandTotal)||0)(u):0;return(0,n.jsxs)("div",{className:"table-row",children:[(0,n.jsxs)("div",{className:"cell qms-info",children:[(0,n.jsx)("div",{className:"qms-id",children:s.id}),(0,n.jsx)("div",{className:"bid-title",children:s.bidTitle||"N/A"}),(0,n.jsxs)("div",{className:"bid-number",children:["#",s.bidNumber]}),(0,n.jsx)("div",{className:"portal-name",children:s.portalName}),(0,n.jsxs)("div",{className:"sourcer-name",children:["\uD83D\uDC64 ",s.sourcerName||s.hunterName||"N/A"]}),(0,n.jsxs)("div",{className:"due-date",children:["\uD83D\uDCC5 ",s.dueDate||"N/A"]})]}),(0,n.jsx)("div",{className:"cell vendor-info",children:u?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"vendor-name",children:(null==(a=u.sourcingInfo)?void 0:a.vendorName)||"Unknown"}),(0,n.jsxs)("div",{className:"vendor-details",children:[(0,n.jsxs)("div",{className:"vendor-website",children:["\uD83C\uDF10 ",(null==(i=u.sourcingInfo)?void 0:i.vendorWebsite)||"N/A"]}),(0,n.jsxs)("div",{className:"vendor-items",children:["\uD83D\uDCE6 ",(null==(t=s.sourcingData)||null==(l=t.vendors)?void 0:l.length)||0," vendor(s)"]}),(0,n.jsxs)("div",{className:"vendor-attachments",children:["\uD83D\uDCCE ",(null==(c=u.sourcingInfo)||null==(r=c.attachments)?void 0:r.length)||0," files"]})]})]}):(0,n.jsx)("div",{className:"no-vendor",children:"No Vendor Data"})}),(0,n.jsxs)("div",{className:"cell status-info",children:[T(s.status),(0,n.jsxs)("div",{className:"status-details",children:[(0,n.jsxs)("div",{children:["By: ",s.approvedBy||s.rejectedBy||"Pending"]}),(0,n.jsx)("div",{children:s.approvedAt||s.rejectedAt||""})]}),s.rejectionReason&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"rejection-reason-summary",children:[s.rejectionReason.substring(0,50),"..."]}),(0,n.jsx)("div",{className:"rejection-sent-indicator",children:"\uD83D\uDCE8 Sent to Sourcing"}),s.rejectionAcknowledged&&(0,n.jsx)("div",{className:"acknowledgment-status-badge",children:"✅ Acknowledged"})]})]}),(0,n.jsxs)("div",{className:"cell value-info",children:[(0,n.jsxs)("div",{className:"total-value",children:["$",h.toFixed(2)]}),(0,n.jsxs)("div",{className:"value-breakdown",children:[(0,n.jsxs)("div",{children:["Subtotal: $",((null==u||null==(o=u.pricing)?void 0:o.subtotal)||0).toFixed(2)]}),(0,n.jsxs)("div",{children:["Tax: $",((null==u||null==(d=u.pricing)?void 0:d.taxAmount)||0).toFixed(2)]}),(0,n.jsxs)("div",{children:["Final: $",((null==u||null==(m=u.pricing)?void 0:m.finalGrandTotal)||h).toFixed(2)]})]})]}),(0,n.jsxs)("div",{className:"cell actions",children:[(0,n.jsx)("button",{className:"btn-review",onClick:()=>V(s.id),title:"Review Details",children:"\uD83D\uDC41️ Review"}),"approval_pending"===s.status&&(0,n.jsxs)("div",{className:"quick-actions",children:[(0,n.jsx)("button",{className:"btn-quick-approve",onClick:()=>X(s.id),children:"✅ Approve"}),(0,n.jsx)("button",{className:"btn-quick-reject",onClick:()=>G(s.id,"table"),children:"❌ Reject"})]}),"approval_approved"===s.status&&(0,n.jsx)("div",{className:"approved-actions",children:(0,n.jsx)("button",{className:"btn-delete-from-approval",onClick:()=>Q(s.id),title:"Delete from Approval Dashboard",style:{background:"linear-gradient(135deg, #dc3545, #c82333)",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:"600",transition:"all 0.3s ease",marginTop:"5px"},children:"\uD83D\uDDD1️ Delete"})}),"approval_rejected"===s.status&&(0,n.jsxs)("div",{className:"rejected-actions",children:[(0,n.jsx)("button",{className:"btn-view-in-sourcing",onClick:()=>e.push("/sourcing/".concat(s.id)),title:"View in Sourcing for Revision",children:"\uD83D\uDD04 View in Sourcing"}),(0,n.jsx)("button",{className:"btn-delete-from-approval",onClick:()=>Q(s.id),title:"Delete from Approval Dashboard",style:{background:"linear-gradient(135deg, #dc3545, #c82333)",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:"600",transition:"all 0.3s ease",marginTop:"5px"},children:"\uD83D\uDDD1️ Delete"})]})]})]},s.id)})]})})]})}},5695:(e,s,a)=>{"use strict";var n=a(8999);a.o(n,"usePathname")&&a.d(s,{usePathname:function(){return n.usePathname}}),a.o(n,"useRouter")&&a.d(s,{useRouter:function(){return n.useRouter}})}},e=>{e.O(0,[623,441,964,358],()=>e(e.s=2732)),_N_E=e.O()}]);