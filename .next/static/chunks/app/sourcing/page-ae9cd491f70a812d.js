(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{4389:()=>{},4711:(e,s,t)=>{Promise.resolve().then(t.bind(t,8555))},5695:(e,s,t)=>{"use strict";var r=t(8999);t.o(r,"usePathname")&&t.d(s,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}})},8555:(e,s,t)=>{"use strict";t.d(s,{default:()=>i});var r=t(5155),n=t(5695),a=t(2115);t(4389);let i=()=>{var e,s;let[t,i]=(0,a.useState)([]),[d,c]=(0,a.useState)(""),[l,o]=(0,a.useState)("all"),u="2025-07-31 23:40:15",h="Mike469-a11y",g=(0,n.useRouter)(),p=()=>{let e=localStorage.getItem("sourcingEntries");if(e)try{let s=JSON.parse(e).filter(e=>!e.hiddenFromSourcing);i(s),console.log("Loaded sourcing entries:",s)}catch(e){console.error("Error parsing sourcing entries:",e),i([])}else console.log("No sourcing entries found in localStorage"),i([])};(0,a.useEffect)(()=>{p();let e=e=>{"sourcingEntries"===e.key&&p()};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[]);let j=e=>"approval_approved"===e.status?"approved":"approval_rejected"===e.status?"rejected":e.sourcingCompleted&&"approval_pending"===e.status?"requested":e.sourcingStarted&&!e.sourcingCompleted?"in_progress":"not_started",x=(0,a.useMemo)(()=>{let e=[...t];if(d.trim()){let s=d.toLowerCase();e=e.filter(e=>e.portalName&&e.portalName.toLowerCase().includes(s)||e.bidNumber&&e.bidNumber.toLowerCase().includes(s)||e.id&&e.id.toLowerCase().includes(s)||e.hunterName&&e.hunterName.toLowerCase().includes(s)||e.assignedBy&&e.assignedBy.toLowerCase().includes(s)||e.bidTitle&&e.bidTitle.toLowerCase().includes(s))}if("all"!==l){let s=new Date;s.setHours(0,0,0,0),e=e.filter(e=>{if("workflow-not-started"===l)return"not_started"===j(e);if("workflow-in-progress"===l)return"in_progress"===j(e);if("workflow-requested"===l)return"requested"===j(e);if("workflow-approved"===l)return"approved"===j(e);if("workflow-rejected"===l)return"rejected"===j(e);if(!e.dueDate)return"active"===l;let t=new Date(e.dueDate);t.setHours(0,0,0,0);let r=Math.ceil((t-s)/864e5);switch(l){case"overdue":return r<0;case"due-soon":return r>=0&&r<=7;case"active":return r>7;default:return!0}})}return e},[t,d,l]),m=e=>{let s=j(e);console.log("Navigating for entry ".concat(e.id," with status: ").concat(s)),g.push("/sourcing/".concat(e.id))},v=e=>{if(!e)return"";try{let s=new Date,t=new Date(e);if(isNaN(t.getTime()))return"";let r=t-s,n=Math.ceil(r/864e5);if(n<0)return"overdue";if(n<=3)return"due-soon";return""}catch(e){return console.error("Error getting days left status:",e),""}},N=(0,a.useMemo)(()=>{let e={total:t.length,notStarted:0,inProgress:0,requested:0,approved:0,rejected:0};return t.forEach(s=>{switch(j(s)){case"not_started":e.notStarted++;break;case"in_progress":e.inProgress++;break;case"requested":e.requested++;break;case"approved":e.approved++;break;case"rejected":e.rejected++}}),e},[t]);return(0,r.jsxs)("div",{className:"sourcing-container",children:[(0,r.jsxs)("div",{className:"sourcing-header",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{children:"Sourcing Dashboard"}),(0,r.jsx)("p",{children:"Manage sourcing activities and vendor relationships"})]}),(0,r.jsxs)("div",{className:"user-info",children:[(0,r.jsxs)("span",{children:["Current User: ",(0,r.jsx)("strong",{children:h})]}),(0,r.jsxs)("span",{children:["Date: ",(0,r.jsxs)("strong",{children:[u," UTC"]})]})]})]}),(0,r.jsxs)("div",{className:"workflow-stats",children:[(0,r.jsxs)("div",{className:"stat-card",children:[(0,r.jsx)("div",{className:"stat-icon",children:"\uD83D\uDCCA"}),(0,r.jsxs)("div",{className:"stat-content",children:[(0,r.jsx)("h3",{children:N.total}),(0,r.jsx)("p",{children:"Total Entries"})]})]}),(0,r.jsxs)("div",{className:"stat-card",children:[(0,r.jsx)("div",{className:"stat-icon",children:"⭕"}),(0,r.jsxs)("div",{className:"stat-content",children:[(0,r.jsx)("h3",{children:N.notStarted}),(0,r.jsx)("p",{children:"Not Started"})]})]}),(0,r.jsxs)("div",{className:"stat-card",children:[(0,r.jsx)("div",{className:"stat-icon",children:"\uD83D\uDD04"}),(0,r.jsxs)("div",{className:"stat-content",children:[(0,r.jsx)("h3",{children:N.inProgress}),(0,r.jsx)("p",{children:"In Progress"})]})]}),(0,r.jsxs)("div",{className:"stat-card",children:[(0,r.jsx)("div",{className:"stat-icon",children:"\uD83D\uDCCB"}),(0,r.jsxs)("div",{className:"stat-content",children:[(0,r.jsx)("h3",{children:N.requested}),(0,r.jsx)("p",{children:"Requested"})]})]}),(0,r.jsxs)("div",{className:"stat-card",children:[(0,r.jsx)("div",{className:"stat-icon",children:"✅"}),(0,r.jsxs)("div",{className:"stat-content",children:[(0,r.jsx)("h3",{children:N.approved}),(0,r.jsx)("p",{children:"Approved"})]})]}),(0,r.jsxs)("div",{className:"stat-card",children:[(0,r.jsx)("div",{className:"stat-icon",children:"❌"}),(0,r.jsxs)("div",{className:"stat-content",children:[(0,r.jsx)("h3",{children:N.rejected}),(0,r.jsx)("p",{children:"Rejected"})]})]})]}),(0,r.jsxs)("div",{className:"sourcing-controls",children:[(0,r.jsxs)("div",{className:"search-filter-section",children:[(0,r.jsxs)("div",{className:"search-container",children:[(0,r.jsx)("input",{type:"text",placeholder:"Search by Portal, Bid Number, QMS ID, Hunter, or Assigned By...",value:d,onChange:e=>{c(e.target.value)},className:"search-input"}),(0,r.jsx)("span",{className:"search-icon",children:"\uD83D\uDD0D"})]}),(0,r.jsx)("div",{className:"filter-container",children:(0,r.jsxs)("select",{value:l,onChange:e=>{o(e.target.value)},className:"filter-select",children:[(0,r.jsx)("option",{value:"all",children:"All Entries"}),(0,r.jsxs)("optgroup",{label:"Workflow Status",children:[(0,r.jsx)("option",{value:"workflow-not-started",children:"⭕ Not Started"}),(0,r.jsx)("option",{value:"workflow-in-progress",children:"\uD83D\uDD04 In Progress"}),(0,r.jsx)("option",{value:"workflow-requested",children:"\uD83D\uDCCB Requested"}),(0,r.jsx)("option",{value:"workflow-approved",children:"✅ Approved"}),(0,r.jsx)("option",{value:"workflow-rejected",children:"❌ Rejected"})]}),(0,r.jsxs)("optgroup",{label:"Due Date Status",children:[(0,r.jsx)("option",{value:"overdue",children:"Overdue"}),(0,r.jsx)("option",{value:"due-soon",children:"Due Soon (≤7 days)"}),(0,r.jsx)("option",{value:"active",children:"Active (>7 days)"})]})]})})]}),(0,r.jsx)("div",{className:"sourcing-actions"})]}),(0,r.jsxs)("div",{style:{padding:"10px",background:"#f0f0f0",margin:"10px 0",borderRadius:"5px",fontSize:"12px"},children:[(0,r.jsx)("strong",{children:"Debug Info:"})," Found ",t.length," sourcing entries in localStorage",(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Filtered:"})," Showing ",x.length," entries (Filter: ",l,', Search: "',d,'")',(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Workflow Stats:"})," Not Started: ",N.notStarted,", In Progress: ",N.inProgress,", Requested: ",N.requested,", Approved: ",N.approved,", Rejected: ",N.rejected,t.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Latest Entry:"})," ",null==(e=t[t.length-1])?void 0:e.id," - ",null==(s=t[t.length-1])?void 0:s.portalName]})]}),(0,r.jsxs)("div",{className:"sourcing-list-container",children:[(0,r.jsxs)("table",{className:"sourcing-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"QMS ID"}),(0,r.jsx)("th",{children:"Portal Name"}),(0,r.jsx)("th",{children:"Bid Number"}),(0,r.jsx)("th",{children:"Due Date"}),(0,r.jsx)("th",{children:"Due Status"}),(0,r.jsx)("th",{children:"Workflow Status"}),(0,r.jsx)("th",{children:"Priority"}),(0,r.jsx)("th",{children:"Days Left"}),(0,r.jsx)("th",{children:"Assign To"}),(0,r.jsx)("th",{children:"Assigned By"}),(0,r.jsx)("th",{children:"Action"})]})}),(0,r.jsx)("tbody",{children:0===x.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:11,children:(0,r.jsxs)("div",{className:"no-sourcing-message",children:[(0,r.jsx)("div",{className:"no-sourcing-icon",children:"\uD83D\uDCCB"}),(0,r.jsx)("h3",{children:"No Sourcing Entries Found"}),(0,r.jsx)("p",{children:0===t.length?"No entries have been assigned for sourcing yet. Complete assignments in the Assignment section to see them here.":"No entries match your current search criteria. (Filter: ".concat(l,', Search: "').concat(d,'")')}),0===t.length&&(0,r.jsx)("button",{className:"btn-create-first",onClick:()=>g.push("/assignment"),children:"Go to Assignment Dashboard"})]})})}):x.map(e=>(0,r.jsxs)("tr",{className:"workflow-status-".concat(j(e)),children:[(0,r.jsx)("td",{children:(0,r.jsx)("div",{className:"sourcing-id-cell",children:e.id})}),(0,r.jsxs)("td",{children:[(0,r.jsx)("div",{className:"sourcing-title",children:e.portalName||"N/A"}),e.bidTitle&&(0,r.jsx)("div",{className:"sourcing-subtitle",children:e.bidTitle})]}),(0,r.jsx)("td",{children:(0,r.jsx)("strong",{children:e.bidNumber||"N/A"})}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{className:"due-date ".concat(v(e.dueDate)),children:e.dueDate||"No due date"})}),(0,r.jsx)("td",{children:(e=>{if(!e.dueDate)return(0,r.jsx)("span",{className:"status-badge status-not-started",children:"Active"});try{let s=new Date,t=new Date(e.dueDate);if(isNaN(t.getTime()))return(0,r.jsx)("span",{className:"status-badge status-not-started",children:"Active"});let n=Math.ceil((t-s)/864e5);if(n<0)return(0,r.jsx)("span",{className:"status-badge status-overdue",children:"Overdue"});if(n<=3)return(0,r.jsx)("span",{className:"status-badge status-review",children:"Critical"});if(n<=7)return(0,r.jsx)("span",{className:"status-badge status-in-progress",children:"In Progress"});return(0,r.jsx)("span",{className:"status-badge status-not-started",children:"Active"})}catch(e){return console.error("Error getting status badge:",e),(0,r.jsx)("span",{className:"status-badge status-not-started",children:"Active"})}})(e)}),(0,r.jsx)("td",{children:(e=>{switch(j(e)){case"approved":return(0,r.jsx)("span",{className:"workflow-status-badge status-approved",children:"✅ Approved"});case"rejected":return(0,r.jsx)("span",{className:"workflow-status-badge status-rejected",children:"❌ Rejected"});case"requested":return(0,r.jsx)("span",{className:"workflow-status-badge status-requested",children:"\uD83D\uDCCB Requested"});case"in_progress":return(0,r.jsx)("span",{className:"workflow-status-badge status-in-progress",children:"\uD83D\uDD04 In Progress"});default:return(0,r.jsx)("span",{className:"workflow-status-badge status-not-started",children:"⭕ Not Started"})}})(e)}),(0,r.jsx)("td",{children:(e=>{if(!e)return null;try{let s=new Date,t=new Date(e);if(isNaN(t.getTime()))return null;let n=t-s,a=Math.ceil(n/864e5);if(a<0)return(0,r.jsx)("span",{className:"priority-badge priority-critical",children:"Overdue"});if(a<=3)return(0,r.jsx)("span",{className:"priority-badge priority-high",children:"Urgent"});if(a<=7)return(0,r.jsx)("span",{className:"priority-badge priority-medium",children:"Soon"});return(0,r.jsx)("span",{className:"priority-badge priority-low",children:"Normal"})}catch(e){return console.error("Error getting priority badge:",e),(0,r.jsx)("span",{className:"priority-badge priority-low",children:"Normal"})}})(e.dueDate)}),(0,r.jsx)("td",{children:(0,r.jsx)("strong",{className:v(e.dueDate),children:(e=>{if(!e)return"No due date";try{let s=new Date,t=new Date(e);if(isNaN(t.getTime()))return"Invalid date";let r=t-s,n=Math.ceil(r/864e5);return n>=0?"".concat(n," days"):"Overdue by ".concat(Math.abs(n)," days")}catch(e){return console.error("Error calculating days left:",e),"Invalid date"}})(e.dueDate)})}),(0,r.jsx)("td",{children:(0,r.jsx)("div",{className:"assigned-name",children:e.hunterName||"Not Assigned"})}),(0,r.jsx)("td",{children:(0,r.jsx)("div",{className:"assigned-by-name",children:e.assignedBy||"Not Set"})}),(0,r.jsx)("td",{children:(0,r.jsx)("div",{className:"source-actions",children:(e=>{switch(j(e)){case"approved":return(0,r.jsxs)("div",{style:{display:"flex",gap:"8px",justifyContent:"center",alignItems:"center"},children:[(0,r.jsx)("button",{className:"btn-approved",onClick:()=>m(e),title:"Edit approved sourcing details",children:"✅ Approved - Edit"}),(0,r.jsx)("button",{className:"btn-danger",onClick:()=>(e=>{if(window.confirm("Are you sure you want to remove entry ".concat(e," from Sourcing Dashboard?\n\nNote: This will NOT affect the Approval section.")))try{let s=localStorage.getItem("sourcingEntries");if(s){let t=JSON.parse(s).map(s=>s.id===e?{...s,hiddenFromSourcing:!0,hiddenAt:u,hiddenBy:h}:s);localStorage.setItem("sourcingEntries",JSON.stringify(t)),i(t.filter(e=>!e.hiddenFromSourcing)),alert("✅ Entry ".concat(e," removed from Sourcing Dashboard.\n\n\uD83D\uDCCB Entry remains available in Approval section."))}}catch(e){console.error("Error hiding entry:",e),alert("❌ Error removing entry. Please try again.")}})(e.id),title:"Remove from Sourcing Dashboard",style:{background:"linear-gradient(135deg, #dc3545, #c82333)",color:"white",border:"none",padding:"8px 12px",borderRadius:"20px",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",boxShadow:"0 2px 8px rgba(220, 53, 69, 0.2)",minWidth:"60px",height:"36px"},children:"\uD83D\uDDD1️"})]});case"rejected":return(0,r.jsx)("button",{className:"btn-rejected",onClick:()=>m(e),title:"Revise and resubmit",children:"❌ Rejected - Revise"});case"requested":return(0,r.jsx)("button",{className:"btn-requested",disabled:!0,title:"Awaiting approval",children:"\uD83D\uDCCB Requested"});case"in_progress":return(0,r.jsx)("button",{className:"btn-started",onClick:()=>m(e),title:"Continue sourcing process",children:"\uD83D\uDCDD Continue"});default:return(0,r.jsx)("button",{className:"btn-start",onClick:()=>m(e),title:"Start sourcing process for this entry",children:"\uD83D\uDE80 Start"})}})(e)})})]},e.id))})]}),x.length>0&&(0,r.jsx)("div",{className:"table-footer",children:(0,r.jsxs)("div",{className:"results-info",children:["Showing ",x.length," of ",t.length," sourcing entries"]})})]})]})}}},e=>{e.O(0,[540,441,964,358],()=>e(e.s=4711)),_N_E=e.O()}]);